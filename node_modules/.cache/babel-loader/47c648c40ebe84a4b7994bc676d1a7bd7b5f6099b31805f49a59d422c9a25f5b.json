{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState } from 'react';\nimport axios from 'axios';\nconst BACKEND_URL = 'http://localhost:8080/api/facturas';\nexport const useFacturas = () => {\n  _s();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  // Obtener todas las facturas\n  const obtenerFacturas = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await axios.get(BACKEND_URL);\n      setLoading(false);\n      return response.data;\n    } catch (err) {\n      setLoading(false);\n      setError('Error al obtener facturas');\n      console.error('Error obteniendo facturas:', err);\n      throw err;\n    }\n  };\n\n  // Guardar factura/boleta en el backend\n  const guardarFactura = async facturaData => {\n    setLoading(true);\n    setError(null);\n    try {\n      // Estructura de datos para el backend\n      const facturaBackend = {\n        tipo_comprobante: facturaData.tipoComprobante,\n        // \"BOLETA\" o \"FACTURA\"\n        numero: facturaData.numero,\n        // \"B001-00001\" o \"F001-00001\"\n        subtotal: facturaData.subtotal,\n        igv: facturaData.igv,\n        total: facturaData.total,\n        metodo_pago: facturaData.metodoPago,\n        // \"EFECTIVO\", \"TARJETA\", \"YAPE\"\n        moneda: facturaData.moneda || \"SOLES\",\n        // \"SOLES\" o \"DOLARES\"\n        tipo_cambio: facturaData.tipo_cambio || null,\n        // âœ… AGREGADO: Tipo de cambio para USD\n        id_cliente: facturaData.id_cliente,\n        // ID del cliente\n        detalles: facturaData.productos.map(producto => ({\n          id_producto: producto.id_producto,\n          cantidad: producto.cantidadVendida || producto.cantidad,\n          precio_unitario: producto.precio,\n          subtotal: producto.subtotalProducto || producto.precio * (producto.cantidadVendida || producto.cantidad)\n        }))\n      };\n      console.log(\"ðŸ“¤ Enviando al backend:\", facturaBackend); // âœ… LOG para debug\n\n      const response = await axios.post(BACKEND_URL, facturaBackend);\n      setLoading(false);\n      return response.data;\n    } catch (err) {\n      var _err$response, _err$response2;\n      setLoading(false);\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data) || 'Error al guardar factura en la base de datos');\n      console.error('âŒ Error guardando factura:', err);\n      console.error('âŒ Respuesta del servidor:', (_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : _err$response2.data); // âœ… LOG adicional\n      throw err;\n    }\n  };\n\n  // Buscar factura por ID\n  const buscarFacturaPorId = async id => {\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await axios.get(`${BACKEND_URL}/${id}`);\n      setLoading(false);\n      return response.data;\n    } catch (err) {\n      setLoading(false);\n      setError('Factura no encontrada');\n      console.error('Error buscando factura:', err);\n      return null;\n    }\n  };\n\n  // Buscar facturas por cliente\n  const buscarFacturasPorCliente = async idCliente => {\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await axios.get(`${BACKEND_URL}/cliente/${idCliente}`);\n      setLoading(false);\n      return response.data;\n    } catch (err) {\n      setLoading(false);\n      setError('No se encontraron facturas para este cliente');\n      console.error('Error buscando facturas por cliente:', err);\n      return [];\n    }\n  };\n\n  // Eliminar factura\n  const eliminarFactura = async id => {\n    setLoading(true);\n    setError(null);\n    try {\n      await axios.delete(`${BACKEND_URL}/${id}`);\n      setLoading(false);\n      return true;\n    } catch (err) {\n      setLoading(false);\n      setError('Error al eliminar factura');\n      console.error('Error eliminando factura:', err);\n      throw err;\n    }\n  };\n\n  // Generar nÃºmero de comprobante automÃ¡tico\n  const generarNumeroComprobante = tipo => {\n    const serie = tipo === \"BOLETA\" ? \"B001\" : \"F001\";\n    const timestamp = Date.now();\n    return `${serie}-${timestamp}`;\n  };\n  return {\n    loading,\n    error,\n    obtenerFacturas,\n    guardarFactura,\n    buscarFacturaPorId,\n    buscarFacturasPorCliente,\n    eliminarFactura,\n    generarNumeroComprobante\n  };\n};\n_s(useFacturas, \"Iz3ozxQ+abMaAIcGIvU8cKUcBeo=\");","map":{"version":3,"names":["useState","axios","BACKEND_URL","useFacturas","_s","loading","setLoading","error","setError","obtenerFacturas","response","get","data","err","console","guardarFactura","facturaData","facturaBackend","tipo_comprobante","tipoComprobante","numero","subtotal","igv","total","metodo_pago","metodoPago","moneda","tipo_cambio","id_cliente","detalles","productos","map","producto","id_producto","cantidad","cantidadVendida","precio_unitario","precio","subtotalProducto","log","post","_err$response","_err$response2","buscarFacturaPorId","id","buscarFacturasPorCliente","idCliente","eliminarFactura","delete","generarNumeroComprobante","tipo","serie","timestamp","Date","now"],"sources":["C:/Users/user/Desktop/PROYECTO-DE-JS-PARCTICA-3/sistema-facturacion/src/hooks/useFacturas.js"],"sourcesContent":["import { useState } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst BACKEND_URL = 'http://localhost:8080/api/facturas';\r\n\r\nexport const useFacturas = () => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  // Obtener todas las facturas\r\n  const obtenerFacturas = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const response = await axios.get(BACKEND_URL);\r\n      setLoading(false);\r\n      return response.data;\r\n    } catch (err) {\r\n      setLoading(false);\r\n      setError('Error al obtener facturas');\r\n      console.error('Error obteniendo facturas:', err);\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  // Guardar factura/boleta en el backend\r\n  const guardarFactura = async (facturaData) => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      // Estructura de datos para el backend\r\n      const facturaBackend = {\r\n        tipo_comprobante: facturaData.tipoComprobante, // \"BOLETA\" o \"FACTURA\"\r\n        numero: facturaData.numero, // \"B001-00001\" o \"F001-00001\"\r\n        subtotal: facturaData.subtotal,\r\n        igv: facturaData.igv,\r\n        total: facturaData.total,\r\n        metodo_pago: facturaData.metodoPago, // \"EFECTIVO\", \"TARJETA\", \"YAPE\"\r\n        moneda: facturaData.moneda || \"SOLES\", // \"SOLES\" o \"DOLARES\"\r\n        tipo_cambio: facturaData.tipo_cambio || null, // âœ… AGREGADO: Tipo de cambio para USD\r\n        id_cliente: facturaData.id_cliente, // ID del cliente\r\n        detalles: facturaData.productos.map(producto => ({\r\n          id_producto: producto.id_producto,\r\n          cantidad: producto.cantidadVendida || producto.cantidad,\r\n          precio_unitario: producto.precio,\r\n          subtotal: producto.subtotalProducto || (producto.precio * (producto.cantidadVendida || producto.cantidad))\r\n        }))\r\n      };\r\n\r\n      console.log(\"ðŸ“¤ Enviando al backend:\", facturaBackend); // âœ… LOG para debug\r\n\r\n      const response = await axios.post(BACKEND_URL, facturaBackend);\r\n      \r\n      setLoading(false);\r\n      return response.data;\r\n    } catch (err) {\r\n      setLoading(false);\r\n      setError(err.response?.data || 'Error al guardar factura en la base de datos');\r\n      console.error('âŒ Error guardando factura:', err);\r\n      console.error('âŒ Respuesta del servidor:', err.response?.data); // âœ… LOG adicional\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  // Buscar factura por ID\r\n  const buscarFacturaPorId = async (id) => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const response = await axios.get(`${BACKEND_URL}/${id}`);\r\n      setLoading(false);\r\n      return response.data;\r\n    } catch (err) {\r\n      setLoading(false);\r\n      setError('Factura no encontrada');\r\n      console.error('Error buscando factura:', err);\r\n      return null;\r\n    }\r\n  };\r\n\r\n  // Buscar facturas por cliente\r\n  const buscarFacturasPorCliente = async (idCliente) => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const response = await axios.get(`${BACKEND_URL}/cliente/${idCliente}`);\r\n      setLoading(false);\r\n      return response.data;\r\n    } catch (err) {\r\n      setLoading(false);\r\n      setError('No se encontraron facturas para este cliente');\r\n      console.error('Error buscando facturas por cliente:', err);\r\n      return [];\r\n    }\r\n  };\r\n\r\n  // Eliminar factura\r\n  const eliminarFactura = async (id) => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      await axios.delete(`${BACKEND_URL}/${id}`);\r\n      setLoading(false);\r\n      return true;\r\n    } catch (err) {\r\n      setLoading(false);\r\n      setError('Error al eliminar factura');\r\n      console.error('Error eliminando factura:', err);\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  // Generar nÃºmero de comprobante automÃ¡tico\r\n  const generarNumeroComprobante = (tipo) => {\r\n    const serie = tipo === \"BOLETA\" ? \"B001\" : \"F001\";\r\n    const timestamp = Date.now();\r\n    return `${serie}-${timestamp}`;\r\n  };\r\n\r\n  return {\r\n    loading,\r\n    error,\r\n    obtenerFacturas,\r\n    guardarFactura,\r\n    buscarFacturaPorId,\r\n    buscarFacturasPorCliente,\r\n    eliminarFactura,\r\n    generarNumeroComprobante\r\n  };\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}