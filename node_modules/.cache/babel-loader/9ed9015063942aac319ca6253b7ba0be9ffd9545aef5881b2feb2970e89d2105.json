{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\PROYECTO-DE-JS-PARCTICA-3\\\\sistema-facturacion\\\\src\\\\components\\\\VentasForm.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport { useClientes } from \"../hooks/useClientes\";\nimport { useFacturas } from \"../hooks/useFacturas\";\nimport { useEmpresas } from \"../hooks/useEmpresas\"; // ‚úÖ Importar hook de empresas\nimport axios from \"axios\";\nimport \"./VentasForm.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VentasForm = ({\n  productos,\n  clientesRegistrados,\n  agregarFactura\n}) => {\n  _s();\n  // Estados para cliente o empresa\n  const [tipoCliente, setTipoCliente] = useState(\"persona\");\n  const [dni, setDni] = useState(\"\");\n  const [ruc, setRuc] = useState(\"\");\n  const [clienteSeleccionado, setClienteSeleccionado] = useState(null);\n  const [empresaSeleccionada, setEmpresaSeleccionada] = useState(null);\n\n  // ‚úÖ Hooks\n  const {\n    buscarClientePorDNI,\n    buscarClienteEnBackend,\n    loading: loadingCliente\n  } = useClientes();\n  const {\n    buscarEmpresaPorRUC,\n    loading: loadingEmpresa,\n    error: errorEmpresa\n  } = useEmpresas();\n  const {\n    guardarFactura,\n    generarNumeroComprobante,\n    loading: loadingFactura,\n    error: errorFactura\n  } = useFacturas();\n\n  // Estados para productos\n  const [codigoProducto, setCodigoProducto] = useState(\"\");\n  const [cantidadProducto, setCantidadProducto] = useState(1);\n  const [productosSeleccionados, setProductosSeleccionados] = useState([]);\n\n  // Estados para factura\n  const [metodoPago, setMetodoPago] = useState(\"efectivo\");\n  const [moneda, setMoneda] = useState(\"PEN\");\n  const [tipoCambio, setTipoCambio] = useState(null);\n\n  // Buscar cliente por DNI, nombre o apellido\n  const buscarCliente = async () => {\n    if (!dni) {\n      alert(\"Ingrese DNI, nombre o apellido del cliente\");\n      return;\n    }\n    const busqueda = dni.toLowerCase().trim();\n    try {\n      // Si tiene 8 d√≠gitos, buscar por DNI exacto\n      if (busqueda.length === 8 && /^\\d+$/.test(busqueda)) {\n        // Buscar en el backend por DNI\n        const clienteBackend = await buscarClienteEnBackend(busqueda);\n        if (clienteBackend && clienteBackend.length > 0) {\n          setClienteSeleccionado({\n            id_cliente: clienteBackend[0].id_cliente,\n            dni: clienteBackend[0].dni,\n            nombreCompleto: clienteBackend[0].nombre_completo,\n            nombres: clienteBackend[0].nombres,\n            apellidoPaterno: clienteBackend[0].apellido_paterno,\n            apellidoMaterno: clienteBackend[0].apellido_materno\n          });\n          return;\n        }\n\n        // Si no est√° en backend, buscar en RENIEC\n        const clienteReniec = await buscarClientePorDNI(busqueda);\n        alert(\"‚ö†Ô∏è Cliente encontrado en RENIEC pero no est√° registrado. Por favor reg√≠strelo primero en la secci√≥n 'Clientes'\");\n        setClienteSeleccionado(null);\n        return;\n      }\n\n      // Si NO es un DNI de 8 d√≠gitos, buscar por NOMBRE en el backend\n      // Hacer una petici√≥n al backend para buscar por nombre/apellido\n      const response = await axios.get(`http://localhost:8080/api/clientes`);\n      const todosLosClientes = response.data;\n\n      // Buscar coincidencias por nombre, apellido paterno o apellido materno\n      const clienteEncontrado = todosLosClientes.find(c => c.nombre_completo && c.nombre_completo.toLowerCase().includes(busqueda) || c.nombres && c.nombres.toLowerCase().includes(busqueda) || c.apellido_paterno && c.apellido_paterno.toLowerCase().includes(busqueda) || c.apellido_materno && c.apellido_materno.toLowerCase().includes(busqueda));\n      if (clienteEncontrado) {\n        setClienteSeleccionado({\n          id_cliente: clienteEncontrado.id_cliente,\n          dni: clienteEncontrado.dni,\n          nombreCompleto: clienteEncontrado.nombre_completo,\n          nombres: clienteEncontrado.nombres,\n          apellidoPaterno: clienteEncontrado.apellido_paterno,\n          apellidoMaterno: clienteEncontrado.apellido_materno\n        });\n        return;\n      }\n\n      // Si no se encontr√≥ nada\n      alert(` No se encontr√≥ ning√∫n cliente con: \"${dni}\"\\n\\nIntente con:\\n- DNI completo (8 d√≠gitos)\\n- Nombre completo\\n- Apellido`);\n      setClienteSeleccionado(null);\n    } catch (err) {\n      console.error(\"Error al buscar cliente:\", err);\n      alert(\" Error al buscar el cliente. Verifique su conexi√≥n al servidor.\");\n      setClienteSeleccionado(null);\n    }\n  };\n\n  // Buscar empresa por RUC (Backend primero, luego SUNAT con registro autom√°tico)\n  const buscarEmpresa = async () => {\n    if (!ruc || ruc.length !== 11) {\n      alert(\"Ingrese un RUC v√°lido (11 d√≠gitos)\");\n      return;\n    }\n    try {\n      // PRIMERO: Buscar en el backend local\n      try {\n        const responseBackend = await axios.get(`http://localhost:8080/api/empresas/ruc/${ruc}`);\n        if (responseBackend.data) {\n          const empresa = responseBackend.data;\n          setEmpresaSeleccionada({\n            id_empresa: empresa.id_empresa,\n            ruc: empresa.ruc,\n            razonSocial: empresa.razon_social,\n            direccion: empresa.direccion || '-',\n            estado: empresa.estado || 'ACTIVO',\n            condicion: empresa.condicion || 'HABIDO',\n            departamento: empresa.departamento || '-',\n            provincia: empresa.provincia || '-',\n            distrito: empresa.distrito || '-',\n            ubigeo: empresa.ubigeo || '-'\n          });\n          alert(\"‚úÖ Empresa encontrada en el sistema\");\n          return;\n        }\n      } catch (backendError) {\n        var _backendError$respons;\n        // ‚úÖ Si es 404, es normal (empresa no registrada), continuar con SUNAT silenciosamente\n        // Solo mostrar error si es diferente a 404\n        if (((_backendError$respons = backendError.response) === null || _backendError$respons === void 0 ? void 0 : _backendError$respons.status) !== 404) {\n          console.error(\"Error al buscar en backend:\", backendError);\n        }\n        // Continuar con SUNAT de todos modos\n      }\n\n      // SEGUNDO: Buscar en SUNAT y registrar autom√°ticamente\n      const empresaSUNAT = await buscarEmpresaPorRUC(ruc);\n      if (empresaSUNAT) {\n        // ‚úÖ REGISTRAR AUTOM√ÅTICAMENTE en el backend\n        try {\n          const empresaData = {\n            ruc: empresaSUNAT.ruc,\n            razon_social: empresaSUNAT.razonSocial,\n            direccion: empresaSUNAT.direccion || '-',\n            departamento: empresaSUNAT.departamento || '-',\n            provincia: empresaSUNAT.provincia || '-',\n            distrito: empresaSUNAT.distrito || '-',\n            estado: empresaSUNAT.estado || 'ACTIVO',\n            condicion: empresaSUNAT.condicion || 'HABIDO'\n          };\n          const responseRegistro = await axios.post('http://localhost:8080/api/empresas', empresaData);\n\n          // Usar la empresa reci√©n registrada (con su id_empresa)\n          setEmpresaSeleccionada({\n            id_empresa: responseRegistro.data.id_empresa,\n            ruc: empresaSUNAT.ruc,\n            razonSocial: empresaSUNAT.razonSocial,\n            direccion: empresaSUNAT.direccion,\n            estado: empresaSUNAT.estado,\n            condicion: empresaSUNAT.condicion,\n            departamento: empresaSUNAT.departamento || '-',\n            provincia: empresaSUNAT.provincia || '-',\n            distrito: empresaSUNAT.distrito || '-',\n            ubigeo: empresaSUNAT.ubigeo || '-'\n          });\n          alert(\"‚úÖ Empresa encontrada en SUNAT y registrada autom√°ticamente\");\n          return; // ‚úÖ IMPORTANTE: Salir aqu√≠ si todo fue exitoso\n        } catch (errorRegistro) {\n          var _errorRegistro$respon;\n          // Si falla el registro (ej: ya existe), intentar buscar nuevamente en backend\n          if (((_errorRegistro$respon = errorRegistro.response) === null || _errorRegistro$respon === void 0 ? void 0 : _errorRegistro$respon.status) === 409) {\n            // La empresa ya existe, buscarla nuevamente\n            const responseBackend = await axios.get(`http://localhost:8080/api/empresas/ruc/${ruc}`);\n            if (responseBackend.data) {\n              setEmpresaSeleccionada({\n                id_empresa: responseBackend.data.id_empresa,\n                ruc: responseBackend.data.ruc,\n                razonSocial: responseBackend.data.razon_social,\n                direccion: responseBackend.data.direccion,\n                estado: responseBackend.data.estado,\n                condicion: responseBackend.data.condicion,\n                departamento: responseBackend.data.departamento || '-',\n                provincia: responseBackend.data.provincia || '-',\n                distrito: responseBackend.data.distrito || '-',\n                ubigeo: responseBackend.data.ubigeo || '-'\n              });\n              alert(\"‚úÖ Empresa encontrada en el sistema\");\n              return; // ‚úÖ IMPORTANTE: Salir aqu√≠ si todo fue exitoso\n            }\n          } else {\n            // Error diferente al 409, propagar\n            throw errorRegistro;\n          }\n        }\n      } else {\n        alert(\"‚ùå No se encontraron datos de la empresa en SUNAT\");\n        setEmpresaSeleccionada(null);\n      }\n    } catch (err) {\n      // Solo manejar errores reales, no los casos de √©xito\n      console.error(\"Error al buscar empresa:\", err);\n      alert(`‚ùå Error: ${err.message || \"No se pudo consultar la empresa\"}`);\n      setEmpresaSeleccionada(null);\n    }\n  };\n\n  // Obtener tipo de cambio si es necesario\n  const obtenerTipoCambio = async () => {\n    // Si ya tenemos el tipo de cambio guardado, retornarlo\n    if (tipoCambio) {\n      return tipoCambio;\n    }\n\n    // Si no tenemos tipo de cambio, obtenerlo de la API\n    try {\n      const response = await axios.get(\"https://api.exchangerate.host/convert?from=USD&to=PEN&amount=1\");\n      const tasaCambio = response.data.result || 3.80;\n      setTipoCambio(tasaCambio);\n      return tasaCambio;\n    } catch (err) {\n      console.error(\"Error al obtener tipo de cambio:\", err);\n      alert(\"No se pudo obtener el tipo de cambio. Usando 3.80 por defecto\");\n      setTipoCambio(3.80);\n      return 3.80;\n    }\n  };\n\n  // Buscar y agregar producto\n  const agregarProducto = () => {\n    if (!codigoProducto) {\n      alert(\"Ingrese un c√≥digo de producto\");\n      return;\n    }\n    const producto = productos.find(p => String(p.id_producto).toLowerCase().includes(codigoProducto.toLowerCase()) || p.nombre.toLowerCase().includes(codigoProducto.toLowerCase()));\n    if (!producto) {\n      alert(\"Producto no encontrado\");\n      return;\n    }\n\n    // Verificar stock disponible\n    if (producto.cantidad < cantidadProducto) {\n      alert(`Stock insuficiente. Solo hay ${producto.cantidad} unidades disponibles`);\n      return;\n    }\n    const existe = productosSeleccionados.find(p => p.id_producto === producto.id_producto);\n    if (existe) {\n      alert(\"Este producto ya est√° agregado. Modifique la cantidad en la tabla.\");\n      return;\n    }\n    const productoConCantidad = {\n      ...producto,\n      cantidadVendida: parseInt(cantidadProducto),\n      subtotalProducto: producto.precio * parseInt(cantidadProducto)\n    };\n    setProductosSeleccionados([...productosSeleccionados, productoConCantidad]);\n    setCodigoProducto(\"\");\n    setCantidadProducto(1);\n  };\n\n  // Eliminar producto de la lista\n  const eliminarProducto = id_producto => {\n    setProductosSeleccionados(productosSeleccionados.filter(p => p.id_producto !== id_producto));\n  };\n\n  // Actualizar cantidad\n  const actualizarCantidad = (id_producto, nuevaCantidad) => {\n    if (nuevaCantidad < 1) return;\n\n    // Verificar stock\n    const producto = productos.find(p => p.id_producto === id_producto);\n    if (producto && nuevaCantidad > producto.cantidad) {\n      alert(`Stock insuficiente. Solo hay ${producto.cantidad} unidades disponibles`);\n      return;\n    }\n    setProductosSeleccionados(productosSeleccionados.map(p => p.id_producto === id_producto ? {\n      ...p,\n      cantidadVendida: parseInt(nuevaCantidad),\n      subtotalProducto: p.precio * parseInt(nuevaCantidad)\n    } : p));\n  };\n\n  // Calcular totales\n  const calcularSubtotal = () => {\n    return productosSeleccionados.reduce((total, p) => total + p.subtotalProducto, 0);\n  };\n  const calcularIGV = () => {\n    return calcularSubtotal() * 0.18;\n  };\n  const calcularTotal = () => {\n    return calcularSubtotal() + calcularIGV();\n  };\n\n  // Generar factura y guardar en backend\n  const generarFacturaVenta = async () => {\n    // Validar que haya cliente o empresa\n    if (!clienteSeleccionado && !empresaSeleccionada) {\n      alert(\"Debe seleccionar un cliente o empresa\");\n      return;\n    }\n    if (productosSeleccionados.length === 0) {\n      alert(\"Debe agregar al menos un producto\");\n      return;\n    }\n\n    // Obtener tipo de cambio si es necesario\n    let cambio = 1;\n    if (moneda === \"USD\") {\n      cambio = await obtenerTipoCambio();\n\n      // Validar que el tipo de cambio sea v√°lido\n      if (!cambio || isNaN(cambio)) {\n        alert(\" Error al obtener el tipo de cambio. Intente nuevamente.\");\n        return;\n      }\n    }\n    const subtotalMoneda = calcularSubtotal();\n    const subtotalSoles = moneda === \"USD\" ? subtotalMoneda * cambio : subtotalMoneda;\n    const igvSoles = subtotalSoles * 0.18;\n    const totalSoles = subtotalSoles + igvSoles;\n\n    // Determinar tipo de comprobante\n    const tipoComprobante = clienteSeleccionado ? \"BOLETA\" : \"FACTURA\";\n\n    // Generar n√∫mero de comprobante\n    const numero = generarNumeroComprobante(tipoComprobante);\n\n    // Validar que tenga id_cliente si es boleta\n    if (tipoComprobante === \"BOLETA\" && !(clienteSeleccionado !== null && clienteSeleccionado !== void 0 && clienteSeleccionado.id_cliente)) {\n      alert(\"‚ùå El cliente debe estar registrado en el sistema\");\n      return;\n    }\n\n    // Validar que tenga id_empresa si es factura\n    if (tipoComprobante === \"FACTURA\" && !(empresaSeleccionada !== null && empresaSeleccionada !== void 0 && empresaSeleccionada.id_empresa)) {\n      alert(\"‚ùå La empresa debe estar registrada en el sistema.\\n\\nPor favor, reg√≠strela primero en la secci√≥n 'Empresas'\");\n      return;\n    }\n\n    // Crear objeto de factura para el backend\n    const facturaData = {\n      tipoComprobante,\n      numero,\n      subtotal: parseFloat(subtotalSoles.toFixed(2)),\n      igv: parseFloat(igvSoles.toFixed(2)),\n      total: parseFloat(totalSoles.toFixed(2)),\n      metodoPago: metodoPago.toUpperCase(),\n      moneda: moneda,\n      // \"PEN\" o \"USD\"\n      tipo_cambio: moneda === \"USD\" ? parseFloat(cambio.toFixed(2)) : null,\n      id_cliente: (clienteSeleccionado === null || clienteSeleccionado === void 0 ? void 0 : clienteSeleccionado.id_cliente) || null,\n      // ID del cliente (para BOLETA)\n      id_empresa: (empresaSeleccionada === null || empresaSeleccionada === void 0 ? void 0 : empresaSeleccionada.id_empresa) || null,\n      // ID de la empresa (para FACTURA)\n      productos: productosSeleccionados.map(p => ({\n        id_producto: p.id_producto,\n        cantidadVendida: p.cantidadVendida,\n        precio: p.precio,\n        subtotalProducto: p.subtotalProducto\n      }))\n    };\n    try {\n      // Guardar en el backend\n      const facturaGuardada = await guardarFactura(facturaData);\n      alert(`‚úÖ ${tipoComprobante} ${numero} registrada exitosamente en la base de datos!`);\n\n      // Si hay funci√≥n del padre (para estado local del frontend)\n      if (agregarFactura) {\n        const facturaParaFrontend = {\n          id: Date.now(),\n          fecha: new Date().toLocaleString(),\n          tipoComprobante: tipoComprobante,\n          cliente: clienteSeleccionado || null,\n          empresa: empresaSeleccionada || null,\n          productos: productosSeleccionados,\n          subtotal: subtotalSoles.toFixed(2),\n          igv: igvSoles.toFixed(2),\n          total: totalSoles.toFixed(2),\n          metodoPago: metodoPago,\n          monedaOriginal: moneda,\n          tipoCambio: moneda === \"USD\" ? cambio.toFixed(2) : null,\n          moneda: moneda\n        };\n        agregarFactura(facturaParaFrontend);\n      }\n\n      // Limpiar formulario\n      limpiarFormulario();\n    } catch (err) {\n      var _err$response, _err$response$data;\n      alert(`‚ùå Error al guardar la venta: ${errorFactura || ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || err.message}`);\n    }\n  };\n  const limpiarFormulario = () => {\n    setTipoCliente(\"persona\");\n    setDni(\"\");\n    setRuc(\"\");\n    setClienteSeleccionado(null);\n    setEmpresaSeleccionada(null);\n    setCodigoProducto(\"\");\n    setCantidadProducto(1);\n    setProductosSeleccionados([]);\n    setMetodoPago(\"efectivo\");\n    setMoneda(\"PEN\");\n    setTipoCambio(null);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ventas-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\uD83D\\uDCDD Registrar Venta\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 426,\n      columnNumber: 7\n    }, this), errorFactura && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      style: {\n        background: '#fee',\n        color: '#c00',\n        padding: '10px',\n        borderRadius: '5px',\n        marginBottom: '15px'\n      },\n      children: [\"\\u26A0\\uFE0F \", errorFactura]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 430,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"seccion-venta\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\uD83D\\uDD0D Buscar Cliente o Empresa\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 443,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tipo-cliente-selector\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"radio\",\n            value: \"persona\",\n            checked: tipoCliente === \"persona\",\n            onChange: e => {\n              setTipoCliente(e.target.value);\n              setEmpresaSeleccionada(null);\n              setClienteSeleccionado(null);\n              setRuc(\"\");\n              setDni(\"\");\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 448,\n            columnNumber: 13\n          }, this), \"\\uD83D\\uDC64 Persona Natural (DNI)\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"radio\",\n            value: \"empresa\",\n            checked: tipoCliente === \"empresa\",\n            onChange: e => {\n              setTipoCliente(e.target.value);\n              setEmpresaSeleccionada(null);\n              setClienteSeleccionado(null);\n              setRuc(\"\");\n              setDni(\"\");\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 463,\n            columnNumber: 13\n          }, this), \"\\uD83C\\uDFE2 Empresa (RUC)\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 462,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 446,\n        columnNumber: 9\n      }, this), tipoCliente === \"persona\" && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group-inline\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"DNI, nombre o apellido del cliente\",\n          value: dni,\n          onChange: e => setDni(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 482,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: buscarCliente,\n          className: \"btn-buscar\",\n          disabled: loadingCliente,\n          children: loadingCliente ? \"Buscando...\" : \"üîç Buscar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 488,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 481,\n        columnNumber: 11\n      }, this), tipoCliente === \"empresa\" && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group-inline\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Ingrese RUC (11 d\\xEDgitos)\",\n          value: ruc,\n          onChange: e => setRuc(e.target.value.replace(/\\D/g, '').slice(0, 11)),\n          maxLength: \"11\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 497,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: buscarEmpresa,\n          className: \"btn-buscar\",\n          disabled: loadingEmpresa,\n          children: loadingEmpresa ? \"Buscando...\" : \"üîç Buscar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 504,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 496,\n        columnNumber: 11\n      }, this), clienteSeleccionado && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cliente-seleccionado\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Cliente:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 513,\n            columnNumber: 16\n          }, this), \" \", clienteSeleccionado.nombreCompleto || `${clienteSeleccionado.nombres} ${clienteSeleccionado.apellidoPaterno}`]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 513,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"DNI:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 514,\n            columnNumber: 16\n          }, this), \" \", clienteSeleccionado.dni]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 514,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: /*#__PURE__*/_jsxDEV(\"em\", {\n            children: \"Se generar\\xE1 una BOLETA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 515,\n            columnNumber: 16\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 515,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 512,\n        columnNumber: 11\n      }, this), empresaSeleccionada && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cliente-seleccionado\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Empresa:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 522,\n            columnNumber: 16\n          }, this), \" \", empresaSeleccionada.razonSocial]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 522,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"RUC:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 523,\n            columnNumber: 16\n          }, this), \" \", empresaSeleccionada.ruc]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 523,\n          columnNumber: 13\n        }, this), empresaSeleccionada.direccion && /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Direcci\\xF3n:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 524,\n            columnNumber: 50\n          }, this), \" \", empresaSeleccionada.direccion]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 524,\n          columnNumber: 47\n        }, this), empresaSeleccionada.estado && /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Estado:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 525,\n            columnNumber: 47\n          }, this), \" \", empresaSeleccionada.estado]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 525,\n          columnNumber: 44\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: /*#__PURE__*/_jsxDEV(\"em\", {\n            children: \" NOTA: Para generar FACTURA, la empresa debe estar registrada como cliente en el sistema\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 526,\n            columnNumber: 16\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 526,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 521,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 442,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"seccion-venta\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\uD83D\\uDD0D Buscar Producto\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 533,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group-inline\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"C\\xF3digo o nombre del producto\",\n          value: codigoProducto,\n          onChange: e => setCodigoProducto(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          placeholder: \"Cantidad\",\n          value: cantidadProducto,\n          onChange: e => setCantidadProducto(e.target.value),\n          min: \"1\",\n          className: \"input-cantidad\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 541,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: agregarProducto,\n          className: \"btn-agregar\",\n          children: \"\\u2795 Agregar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 549,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 534,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 532,\n      columnNumber: 7\n    }, this), productosSeleccionados.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"seccion-venta\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\uD83D\\uDED2 Productos Seleccionados\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 558,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"tabla-productos-venta\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"C\\xF3digo\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 562,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Producto\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 563,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Precio Unit.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 564,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Cantidad\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 565,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Subtotal\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 566,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Acci\\xF3n\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 567,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 561,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 560,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: productosSeleccionados.map(producto => /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              children: producto.id_producto\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 573,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: producto.nombre\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 574,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: [\"S/ \", producto.precio.toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 575,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                value: producto.cantidadVendida,\n                onChange: e => actualizarCantidad(producto.id_producto, e.target.value),\n                min: \"1\",\n                max: producto.cantidad,\n                className: \"input-cantidad-tabla\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 577,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 576,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: [\"S/ \", producto.subtotalProducto.toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 586,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => eliminarProducto(producto.id_producto),\n                className: \"btn-eliminar\",\n                children: \"\\uD83D\\uDDD1\\uFE0F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 588,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 587,\n              columnNumber: 19\n            }, this)]\n          }, producto.id_producto, true, {\n            fileName: _jsxFileName,\n            lineNumber: 572,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 570,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 559,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 557,\n      columnNumber: 9\n    }, this), productosSeleccionados.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"seccion-venta\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"totales-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"totales\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"fila-total\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Subtotal:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 608,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"S/ \", calcularSubtotal().toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 609,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 607,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"fila-total\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"IGV (18%):\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 612,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"S/ \", calcularIGV().toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 613,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 611,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"fila-total total-final\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"TOTAL:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 616,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"S/ \", calcularTotal().toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 617,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 615,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 606,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"metodo-pago\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"\\uD83D\\uDCB3 M\\xE9todo de Pago\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 622,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"opciones-pago\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: \"efectivo\",\n                checked: metodoPago === \"efectivo\",\n                onChange: e => setMetodoPago(e.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 625,\n                columnNumber: 19\n              }, this), \"\\uD83D\\uDCB5 Efectivo\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 624,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: \"tarjeta\",\n                checked: metodoPago === \"tarjeta\",\n                onChange: e => setMetodoPago(e.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 634,\n                columnNumber: 19\n              }, this), \"\\uD83D\\uDCB3 Tarjeta\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 633,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 623,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"opciones-moneda\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: \"PEN\",\n                checked: moneda === \"PEN\",\n                onChange: e => {\n                  setMoneda(e.target.value);\n                  setTipoCambio(null);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 646,\n                columnNumber: 19\n              }, this), \"\\uD83C\\uDDF5\\uD83C\\uDDEA Soles (PEN)\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 645,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: \"USD\",\n                checked: moneda === \"USD\",\n                onChange: e => {\n                  setMoneda(e.target.value);\n                  obtenerTipoCambio();\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 658,\n                columnNumber: 19\n              }, this), \"\\uD83D\\uDCB5 D\\xF3lares (USD)\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 657,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 644,\n            columnNumber: 15\n          }, this), moneda === \"USD\" && tipoCambio && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"tipo-cambio-info\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u26A0\\uFE0F Tipo de cambio:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 673,\n                columnNumber: 22\n              }, this), \" $1 USD = S/ \", tipoCambio.toFixed(2), \" PEN\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 673,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: /*#__PURE__*/_jsxDEV(\"em\", {\n                children: \"Los totales se mostrar\\xE1n en Soles (requerimiento SUNAT)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 674,\n                columnNumber: 22\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 674,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 672,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 621,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 605,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: generarFacturaVenta,\n        className: \"btn-generar-factura\",\n        disabled: loadingFactura,\n        children: loadingFactura ? \"‚è≥ Guardando...\" : clienteSeleccionado ? \"üßæ Generar Boleta\" : \"üìÑ Generar Factura\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 680,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 604,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 425,\n    columnNumber: 5\n  }, this);\n};\n_s(VentasForm, \"VyopPETFvJoxPc7kLiXU6p2S3OE=\", false, function () {\n  return [useClientes, useEmpresas, useFacturas];\n});\n_c = VentasForm;\nexport default VentasForm;\nvar _c;\n$RefreshReg$(_c, \"VentasForm\");","map":{"version":3,"names":["React","useState","useClientes","useFacturas","useEmpresas","axios","jsxDEV","_jsxDEV","VentasForm","productos","clientesRegistrados","agregarFactura","_s","tipoCliente","setTipoCliente","dni","setDni","ruc","setRuc","clienteSeleccionado","setClienteSeleccionado","empresaSeleccionada","setEmpresaSeleccionada","buscarClientePorDNI","buscarClienteEnBackend","loading","loadingCliente","buscarEmpresaPorRUC","loadingEmpresa","error","errorEmpresa","guardarFactura","generarNumeroComprobante","loadingFactura","errorFactura","codigoProducto","setCodigoProducto","cantidadProducto","setCantidadProducto","productosSeleccionados","setProductosSeleccionados","metodoPago","setMetodoPago","moneda","setMoneda","tipoCambio","setTipoCambio","buscarCliente","alert","busqueda","toLowerCase","trim","length","test","clienteBackend","id_cliente","nombreCompleto","nombre_completo","nombres","apellidoPaterno","apellido_paterno","apellidoMaterno","apellido_materno","clienteReniec","response","get","todosLosClientes","data","clienteEncontrado","find","c","includes","err","console","buscarEmpresa","responseBackend","empresa","id_empresa","razonSocial","razon_social","direccion","estado","condicion","departamento","provincia","distrito","ubigeo","backendError","_backendError$respons","status","empresaSUNAT","empresaData","responseRegistro","post","errorRegistro","_errorRegistro$respon","message","obtenerTipoCambio","tasaCambio","result","agregarProducto","producto","p","String","id_producto","nombre","cantidad","existe","productoConCantidad","cantidadVendida","parseInt","subtotalProducto","precio","eliminarProducto","filter","actualizarCantidad","nuevaCantidad","map","calcularSubtotal","reduce","total","calcularIGV","calcularTotal","generarFacturaVenta","cambio","isNaN","subtotalMoneda","subtotalSoles","igvSoles","totalSoles","tipoComprobante","numero","facturaData","subtotal","parseFloat","toFixed","igv","toUpperCase","tipo_cambio","facturaGuardada","facturaParaFrontend","id","Date","now","fecha","toLocaleString","cliente","monedaOriginal","limpiarFormulario","_err$response","_err$response$data","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","background","color","padding","borderRadius","marginBottom","type","value","checked","onChange","e","target","placeholder","onClick","disabled","replace","slice","maxLength","min","max","_c","$RefreshReg$"],"sources":["C:/Users/user/Desktop/PROYECTO-DE-JS-PARCTICA-3/sistema-facturacion/src/components/VentasForm.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { useClientes } from \"../hooks/useClientes\";\r\nimport { useFacturas } from \"../hooks/useFacturas\";\r\nimport { useEmpresas } from \"../hooks/useEmpresas\"; // ‚úÖ Importar hook de empresas\r\nimport axios from \"axios\";\r\nimport \"./VentasForm.css\";\r\n\r\nconst VentasForm = ({ productos, clientesRegistrados, agregarFactura }) => {\r\n  // Estados para cliente o empresa\r\n  const [tipoCliente, setTipoCliente] = useState(\"persona\");\r\n  const [dni, setDni] = useState(\"\");\r\n  const [ruc, setRuc] = useState(\"\");\r\n  const [clienteSeleccionado, setClienteSeleccionado] = useState(null);\r\n  const [empresaSeleccionada, setEmpresaSeleccionada] = useState(null);\r\n  \r\n  // ‚úÖ Hooks\r\n  const { buscarClientePorDNI, buscarClienteEnBackend, loading: loadingCliente } = useClientes();\r\n  const { buscarEmpresaPorRUC, loading: loadingEmpresa, error: errorEmpresa } = useEmpresas();\r\n  const { guardarFactura, generarNumeroComprobante, loading: loadingFactura, error: errorFactura } = useFacturas();\r\n\r\n  // Estados para productos\r\n  const [codigoProducto, setCodigoProducto] = useState(\"\");\r\n  const [cantidadProducto, setCantidadProducto] = useState(1);\r\n  const [productosSeleccionados, setProductosSeleccionados] = useState([]);\r\n\r\n  // Estados para factura\r\n  const [metodoPago, setMetodoPago] = useState(\"efectivo\");\r\n  const [moneda, setMoneda] = useState(\"PEN\");\r\n  const [tipoCambio, setTipoCambio] = useState(null);\r\n\r\n  // Buscar cliente por DNI, nombre o apellido\r\n  const buscarCliente = async () => {\r\n    if (!dni) {\r\n      alert(\"Ingrese DNI, nombre o apellido del cliente\");\r\n      return;\r\n    }\r\n\r\n    const busqueda = dni.toLowerCase().trim();\r\n\r\n    try {\r\n      // Si tiene 8 d√≠gitos, buscar por DNI exacto\r\n      if (busqueda.length === 8 && /^\\d+$/.test(busqueda)) {\r\n        // Buscar en el backend por DNI\r\n        const clienteBackend = await buscarClienteEnBackend(busqueda);\r\n        \r\n        if (clienteBackend && clienteBackend.length > 0) {\r\n          setClienteSeleccionado({\r\n            id_cliente: clienteBackend[0].id_cliente,\r\n            dni: clienteBackend[0].dni,\r\n            nombreCompleto: clienteBackend[0].nombre_completo,\r\n            nombres: clienteBackend[0].nombres,\r\n            apellidoPaterno: clienteBackend[0].apellido_paterno,\r\n            apellidoMaterno: clienteBackend[0].apellido_materno\r\n          });\r\n          return;\r\n        }\r\n\r\n        // Si no est√° en backend, buscar en RENIEC\r\n        const clienteReniec = await buscarClientePorDNI(busqueda);\r\n        alert(\"‚ö†Ô∏è Cliente encontrado en RENIEC pero no est√° registrado. Por favor reg√≠strelo primero en la secci√≥n 'Clientes'\");\r\n        setClienteSeleccionado(null);\r\n        return;\r\n      }\r\n\r\n      // Si NO es un DNI de 8 d√≠gitos, buscar por NOMBRE en el backend\r\n      // Hacer una petici√≥n al backend para buscar por nombre/apellido\r\n      const response = await axios.get(`http://localhost:8080/api/clientes`);\r\n      const todosLosClientes = response.data;\r\n      \r\n      // Buscar coincidencias por nombre, apellido paterno o apellido materno\r\n      const clienteEncontrado = todosLosClientes.find(c => \r\n        (c.nombre_completo && c.nombre_completo.toLowerCase().includes(busqueda)) ||\r\n        (c.nombres && c.nombres.toLowerCase().includes(busqueda)) ||\r\n        (c.apellido_paterno && c.apellido_paterno.toLowerCase().includes(busqueda)) ||\r\n        (c.apellido_materno && c.apellido_materno.toLowerCase().includes(busqueda))\r\n      );\r\n\r\n      if (clienteEncontrado) {\r\n        setClienteSeleccionado({\r\n          id_cliente: clienteEncontrado.id_cliente,\r\n          dni: clienteEncontrado.dni,\r\n          nombreCompleto: clienteEncontrado.nombre_completo,\r\n          nombres: clienteEncontrado.nombres,\r\n          apellidoPaterno: clienteEncontrado.apellido_paterno,\r\n          apellidoMaterno: clienteEncontrado.apellido_materno\r\n        });\r\n        return;\r\n      }\r\n\r\n      // Si no se encontr√≥ nada\r\n      alert(` No se encontr√≥ ning√∫n cliente con: \"${dni}\"\\n\\nIntente con:\\n- DNI completo (8 d√≠gitos)\\n- Nombre completo\\n- Apellido`);\r\n      setClienteSeleccionado(null);\r\n\r\n    } catch (err) {\r\n      console.error(\"Error al buscar cliente:\", err);\r\n      alert(\" Error al buscar el cliente. Verifique su conexi√≥n al servidor.\");\r\n      setClienteSeleccionado(null);\r\n    }\r\n  };\r\n\r\n  // Buscar empresa por RUC (Backend primero, luego SUNAT con registro autom√°tico)\r\n  const buscarEmpresa = async () => {\r\n    if (!ruc || ruc.length !== 11) {\r\n      alert(\"Ingrese un RUC v√°lido (11 d√≠gitos)\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // PRIMERO: Buscar en el backend local\r\n      try {\r\n        const responseBackend = await axios.get(`http://localhost:8080/api/empresas/ruc/${ruc}`);\r\n        \r\n        if (responseBackend.data) {\r\n          const empresa = responseBackend.data;\r\n          setEmpresaSeleccionada({\r\n            id_empresa: empresa.id_empresa,\r\n            ruc: empresa.ruc,\r\n            razonSocial: empresa.razon_social,\r\n            direccion: empresa.direccion || '-',\r\n            estado: empresa.estado || 'ACTIVO',\r\n            condicion: empresa.condicion || 'HABIDO',\r\n            departamento: empresa.departamento || '-',\r\n            provincia: empresa.provincia || '-',\r\n            distrito: empresa.distrito || '-',\r\n            ubigeo: empresa.ubigeo || '-'\r\n          });\r\n          alert(\"‚úÖ Empresa encontrada en el sistema\");\r\n          return;\r\n        }\r\n      } catch (backendError) {\r\n        // ‚úÖ Si es 404, es normal (empresa no registrada), continuar con SUNAT silenciosamente\r\n        // Solo mostrar error si es diferente a 404\r\n        if (backendError.response?.status !== 404) {\r\n          console.error(\"Error al buscar en backend:\", backendError);\r\n        }\r\n        // Continuar con SUNAT de todos modos\r\n      }\r\n\r\n      // SEGUNDO: Buscar en SUNAT y registrar autom√°ticamente\r\n      const empresaSUNAT = await buscarEmpresaPorRUC(ruc);\r\n\r\n      if (empresaSUNAT) {\r\n        // ‚úÖ REGISTRAR AUTOM√ÅTICAMENTE en el backend\r\n        try {\r\n          const empresaData = {\r\n            ruc: empresaSUNAT.ruc,\r\n            razon_social: empresaSUNAT.razonSocial,\r\n            direccion: empresaSUNAT.direccion || '-',\r\n            departamento: empresaSUNAT.departamento || '-',\r\n            provincia: empresaSUNAT.provincia || '-',\r\n            distrito: empresaSUNAT.distrito || '-',\r\n            estado: empresaSUNAT.estado || 'ACTIVO',\r\n            condicion: empresaSUNAT.condicion || 'HABIDO'\r\n          };\r\n\r\n          const responseRegistro = await axios.post('http://localhost:8080/api/empresas', empresaData);\r\n          \r\n          // Usar la empresa reci√©n registrada (con su id_empresa)\r\n          setEmpresaSeleccionada({\r\n            id_empresa: responseRegistro.data.id_empresa,\r\n            ruc: empresaSUNAT.ruc,\r\n            razonSocial: empresaSUNAT.razonSocial,\r\n            direccion: empresaSUNAT.direccion,\r\n            estado: empresaSUNAT.estado,\r\n            condicion: empresaSUNAT.condicion,\r\n            departamento: empresaSUNAT.departamento || '-',\r\n            provincia: empresaSUNAT.provincia || '-',\r\n            distrito: empresaSUNAT.distrito || '-',\r\n            ubigeo: empresaSUNAT.ubigeo || '-'\r\n          });\r\n          \r\n          alert(\"‚úÖ Empresa encontrada en SUNAT y registrada autom√°ticamente\");\r\n          return; // ‚úÖ IMPORTANTE: Salir aqu√≠ si todo fue exitoso\r\n        } catch (errorRegistro) {\r\n          // Si falla el registro (ej: ya existe), intentar buscar nuevamente en backend\r\n          if (errorRegistro.response?.status === 409) {\r\n            // La empresa ya existe, buscarla nuevamente\r\n            const responseBackend = await axios.get(`http://localhost:8080/api/empresas/ruc/${ruc}`);\r\n            if (responseBackend.data) {\r\n              setEmpresaSeleccionada({\r\n                id_empresa: responseBackend.data.id_empresa,\r\n                ruc: responseBackend.data.ruc,\r\n                razonSocial: responseBackend.data.razon_social,\r\n                direccion: responseBackend.data.direccion,\r\n                estado: responseBackend.data.estado,\r\n                condicion: responseBackend.data.condicion,\r\n                departamento: responseBackend.data.departamento || '-',\r\n                provincia: responseBackend.data.provincia || '-',\r\n                distrito: responseBackend.data.distrito || '-',\r\n                ubigeo: responseBackend.data.ubigeo || '-'\r\n              });\r\n              alert(\"‚úÖ Empresa encontrada en el sistema\");\r\n              return; // ‚úÖ IMPORTANTE: Salir aqu√≠ si todo fue exitoso\r\n            }\r\n          } else {\r\n            // Error diferente al 409, propagar\r\n            throw errorRegistro;\r\n          }\r\n        }\r\n      } else {\r\n        alert(\"‚ùå No se encontraron datos de la empresa en SUNAT\");\r\n        setEmpresaSeleccionada(null);\r\n      }\r\n    } catch (err) {\r\n      // Solo manejar errores reales, no los casos de √©xito\r\n      console.error(\"Error al buscar empresa:\", err);\r\n      alert(`‚ùå Error: ${err.message || \"No se pudo consultar la empresa\"}`);\r\n      setEmpresaSeleccionada(null);\r\n    }\r\n  };\r\n\r\n  // Obtener tipo de cambio si es necesario\r\n  const obtenerTipoCambio = async () => {\r\n    // Si ya tenemos el tipo de cambio guardado, retornarlo\r\n    if (tipoCambio) {\r\n      return tipoCambio;\r\n    }\r\n\r\n    // Si no tenemos tipo de cambio, obtenerlo de la API\r\n    try {\r\n      const response = await axios.get(\"https://api.exchangerate.host/convert?from=USD&to=PEN&amount=1\");\r\n      const tasaCambio = response.data.result || 3.80;\r\n      setTipoCambio(tasaCambio);\r\n      return tasaCambio;\r\n    } catch (err) {\r\n      console.error(\"Error al obtener tipo de cambio:\", err);\r\n      alert(\"No se pudo obtener el tipo de cambio. Usando 3.80 por defecto\");\r\n      setTipoCambio(3.80);\r\n      return 3.80;\r\n    }\r\n  };\r\n\r\n  // Buscar y agregar producto\r\n  const agregarProducto = () => {\r\n    if (!codigoProducto) {\r\n      alert(\"Ingrese un c√≥digo de producto\");\r\n      return;\r\n    }\r\n\r\n    const producto = productos.find(p => \r\n      String(p.id_producto).toLowerCase().includes(codigoProducto.toLowerCase()) ||\r\n      p.nombre.toLowerCase().includes(codigoProducto.toLowerCase())\r\n    );\r\n\r\n    if (!producto) {\r\n      alert(\"Producto no encontrado\");\r\n      return;\r\n    }\r\n\r\n    // Verificar stock disponible\r\n    if (producto.cantidad < cantidadProducto) {\r\n      alert(`Stock insuficiente. Solo hay ${producto.cantidad} unidades disponibles`);\r\n      return;\r\n    }\r\n\r\n    const existe = productosSeleccionados.find(p => p.id_producto === producto.id_producto);\r\n    if (existe) {\r\n      alert(\"Este producto ya est√° agregado. Modifique la cantidad en la tabla.\");\r\n      return;\r\n    }\r\n\r\n    const productoConCantidad = {\r\n      ...producto,\r\n      cantidadVendida: parseInt(cantidadProducto),\r\n      subtotalProducto: producto.precio * parseInt(cantidadProducto)\r\n    };\r\n\r\n    setProductosSeleccionados([...productosSeleccionados, productoConCantidad]);\r\n    setCodigoProducto(\"\");\r\n    setCantidadProducto(1);\r\n  };\r\n\r\n  // Eliminar producto de la lista\r\n  const eliminarProducto = (id_producto) => {\r\n    setProductosSeleccionados(productosSeleccionados.filter(p => p.id_producto !== id_producto));\r\n  };\r\n\r\n  // Actualizar cantidad\r\n  const actualizarCantidad = (id_producto, nuevaCantidad) => {\r\n    if (nuevaCantidad < 1) return;\r\n    \r\n    // Verificar stock\r\n    const producto = productos.find(p => p.id_producto === id_producto);\r\n    if (producto && nuevaCantidad > producto.cantidad) {\r\n      alert(`Stock insuficiente. Solo hay ${producto.cantidad} unidades disponibles`);\r\n      return;\r\n    }\r\n    \r\n    setProductosSeleccionados(productosSeleccionados.map(p => \r\n      p.id_producto === id_producto \r\n        ? { ...p, cantidadVendida: parseInt(nuevaCantidad), subtotalProducto: p.precio * parseInt(nuevaCantidad) }\r\n        : p\r\n    ));\r\n  };\r\n\r\n  // Calcular totales\r\n  const calcularSubtotal = () => {\r\n    return productosSeleccionados.reduce((total, p) => total + p.subtotalProducto, 0);\r\n  };\r\n\r\n  const calcularIGV = () => {\r\n    return calcularSubtotal() * 0.18;\r\n  };\r\n\r\n  const calcularTotal = () => {\r\n    return calcularSubtotal() + calcularIGV();\r\n  };\r\n\r\n  // Generar factura y guardar en backend\r\n  const generarFacturaVenta = async () => {\r\n    // Validar que haya cliente o empresa\r\n    if (!clienteSeleccionado && !empresaSeleccionada) {\r\n      alert(\"Debe seleccionar un cliente o empresa\");\r\n      return;\r\n    }\r\n\r\n    if (productosSeleccionados.length === 0) {\r\n      alert(\"Debe agregar al menos un producto\");\r\n      return;\r\n    }\r\n\r\n    // Obtener tipo de cambio si es necesario\r\n    let cambio = 1;\r\n    if (moneda === \"USD\") {\r\n      cambio = await obtenerTipoCambio();\r\n      \r\n      // Validar que el tipo de cambio sea v√°lido\r\n      if (!cambio || isNaN(cambio)) {\r\n        alert(\" Error al obtener el tipo de cambio. Intente nuevamente.\");\r\n        return;\r\n      }\r\n    }\r\n\r\n    const subtotalMoneda = calcularSubtotal();\r\n    const subtotalSoles = moneda === \"USD\" ? subtotalMoneda * cambio : subtotalMoneda;\r\n    const igvSoles = subtotalSoles * 0.18;\r\n    const totalSoles = subtotalSoles + igvSoles;\r\n\r\n    // Determinar tipo de comprobante\r\n    const tipoComprobante = clienteSeleccionado ? \"BOLETA\" : \"FACTURA\";\r\n    \r\n    // Generar n√∫mero de comprobante\r\n    const numero = generarNumeroComprobante(tipoComprobante);\r\n\r\n    // Validar que tenga id_cliente si es boleta\r\n    if (tipoComprobante === \"BOLETA\" && !clienteSeleccionado?.id_cliente) {\r\n      alert(\"‚ùå El cliente debe estar registrado en el sistema\");\r\n      return;\r\n    }\r\n\r\n    // Validar que tenga id_empresa si es factura\r\n    if (tipoComprobante === \"FACTURA\" && !empresaSeleccionada?.id_empresa) {\r\n      alert(\"‚ùå La empresa debe estar registrada en el sistema.\\n\\nPor favor, reg√≠strela primero en la secci√≥n 'Empresas'\");\r\n      return;\r\n    }\r\n\r\n    // Crear objeto de factura para el backend\r\n    const facturaData = {\r\n      tipoComprobante,\r\n      numero,\r\n      subtotal: parseFloat(subtotalSoles.toFixed(2)),\r\n      igv: parseFloat(igvSoles.toFixed(2)),\r\n      total: parseFloat(totalSoles.toFixed(2)),\r\n      metodoPago: metodoPago.toUpperCase(),\r\n      moneda: moneda, // \"PEN\" o \"USD\"\r\n      tipo_cambio: moneda === \"USD\" ? parseFloat(cambio.toFixed(2)) : null,\r\n      id_cliente: clienteSeleccionado?.id_cliente || null, // ID del cliente (para BOLETA)\r\n      id_empresa: empresaSeleccionada?.id_empresa || null, // ID de la empresa (para FACTURA)\r\n      productos: productosSeleccionados.map(p => ({\r\n        id_producto: p.id_producto,\r\n        cantidadVendida: p.cantidadVendida,\r\n        precio: p.precio,\r\n        subtotalProducto: p.subtotalProducto\r\n      }))\r\n    };\r\n\r\n    try {\r\n      // Guardar en el backend\r\n      const facturaGuardada = await guardarFactura(facturaData);\r\n    \r\n      alert(`‚úÖ ${tipoComprobante} ${numero} registrada exitosamente en la base de datos!`);\r\n      \r\n      // Si hay funci√≥n del padre (para estado local del frontend)\r\n      if (agregarFactura) {\r\n        const facturaParaFrontend = {\r\n          id: Date.now(),\r\n          fecha: new Date().toLocaleString(),\r\n          tipoComprobante: tipoComprobante,\r\n          cliente: clienteSeleccionado || null,\r\n          empresa: empresaSeleccionada || null,\r\n          productos: productosSeleccionados,\r\n          subtotal: subtotalSoles.toFixed(2),\r\n          igv: igvSoles.toFixed(2),\r\n          total: totalSoles.toFixed(2),\r\n          metodoPago: metodoPago,\r\n          monedaOriginal: moneda,\r\n          tipoCambio: moneda === \"USD\" ? cambio.toFixed(2) : null,\r\n          moneda: moneda\r\n        };\r\n        agregarFactura(facturaParaFrontend);\r\n      }\r\n      \r\n      // Limpiar formulario\r\n      limpiarFormulario();\r\n    } catch (err) {\r\n      alert(`‚ùå Error al guardar la venta: ${errorFactura || err.response?.data?.message || err.message}`);\r\n    }\r\n  };\r\n\r\n  const limpiarFormulario = () => {\r\n    setTipoCliente(\"persona\");\r\n    setDni(\"\");\r\n    setRuc(\"\");\r\n    setClienteSeleccionado(null);\r\n    setEmpresaSeleccionada(null);\r\n    setCodigoProducto(\"\");\r\n    setCantidadProducto(1);\r\n    setProductosSeleccionados([]);\r\n    setMetodoPago(\"efectivo\");\r\n    setMoneda(\"PEN\");\r\n    setTipoCambio(null);\r\n  };\r\n\r\n  return (\r\n    <div className=\"ventas-container\">\r\n      <h2>üìù Registrar Venta</h2>\r\n\r\n      {/* Mostrar error si existe */}\r\n      {errorFactura && (\r\n        <div className=\"error-message\" style={{\r\n          background: '#fee', \r\n          color: '#c00', \r\n          padding: '10px', \r\n          borderRadius: '5px', \r\n          marginBottom: '15px'\r\n        }}>\r\n          ‚ö†Ô∏è {errorFactura}\r\n        </div>\r\n      )}\r\n\r\n      {/* Secci√≥n 1: Seleccionar tipo y buscar Cliente/Empresa */}\r\n      <div className=\"seccion-venta\">\r\n        <h3>üîç Buscar Cliente o Empresa</h3>\r\n        \r\n        {/* Radio buttons para seleccionar tipo */}\r\n        <div className=\"tipo-cliente-selector\">\r\n          <label>\r\n            <input\r\n              type=\"radio\"\r\n              value=\"persona\"\r\n              checked={tipoCliente === \"persona\"}\r\n              onChange={(e) => {\r\n                setTipoCliente(e.target.value);\r\n                setEmpresaSeleccionada(null);\r\n                setClienteSeleccionado(null);\r\n                setRuc(\"\");\r\n                setDni(\"\");\r\n              }}\r\n            />\r\n            üë§ Persona Natural (DNI)\r\n          </label>\r\n          <label>\r\n            <input\r\n              type=\"radio\"\r\n              value=\"empresa\"\r\n              checked={tipoCliente === \"empresa\"}\r\n              onChange={(e) => {\r\n                setTipoCliente(e.target.value);\r\n                setEmpresaSeleccionada(null);\r\n                setClienteSeleccionado(null);\r\n                setRuc(\"\");\r\n                setDni(\"\");\r\n              }}\r\n            />\r\n            üè¢ Empresa (RUC)\r\n          </label>\r\n        </div>\r\n\r\n        {/* Buscar Persona */}\r\n        {tipoCliente === \"persona\" && (\r\n          <div className=\"form-group-inline\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"DNI, nombre o apellido del cliente\"\r\n              value={dni}\r\n              onChange={(e) => setDni(e.target.value)}\r\n            />\r\n            <button onClick={buscarCliente} className=\"btn-buscar\" disabled={loadingCliente}>\r\n              {loadingCliente ? \"Buscando...\" : \"üîç Buscar\"}\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Buscar Empresa */}\r\n        {tipoCliente === \"empresa\" && (\r\n          <div className=\"form-group-inline\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Ingrese RUC (11 d√≠gitos)\"\r\n              value={ruc}\r\n              onChange={(e) => setRuc(e.target.value.replace(/\\D/g, '').slice(0, 11))}\r\n              maxLength=\"11\"\r\n            />\r\n            <button onClick={buscarEmpresa} className=\"btn-buscar\" disabled={loadingEmpresa}>\r\n              {loadingEmpresa ? \"Buscando...\" : \"üîç Buscar\"}\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Mostrar cliente seleccionado */}\r\n        {clienteSeleccionado && (\r\n          <div className=\"cliente-seleccionado\">\r\n            <p><strong>Cliente:</strong> {clienteSeleccionado.nombreCompleto || `${clienteSeleccionado.nombres} ${clienteSeleccionado.apellidoPaterno}`}</p>\r\n            <p><strong>DNI:</strong> {clienteSeleccionado.dni}</p>\r\n            <p><em>Se generar√° una BOLETA</em></p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Mostrar empresa seleccionada */}\r\n        {empresaSeleccionada && (\r\n          <div className=\"cliente-seleccionado\">\r\n            <p><strong>Empresa:</strong> {empresaSeleccionada.razonSocial}</p>\r\n            <p><strong>RUC:</strong> {empresaSeleccionada.ruc}</p>\r\n            {empresaSeleccionada.direccion && <p><strong>Direcci√≥n:</strong> {empresaSeleccionada.direccion}</p>}\r\n            {empresaSeleccionada.estado && <p><strong>Estado:</strong> {empresaSeleccionada.estado}</p>}\r\n            <p><em> NOTA: Para generar FACTURA, la empresa debe estar registrada como cliente en el sistema</em></p>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Secci√≥n 2: Buscar y Agregar Producto */}\r\n      <div className=\"seccion-venta\">\r\n        <h3>üîç Buscar Producto</h3>\r\n        <div className=\"form-group-inline\">\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"C√≥digo o nombre del producto\"\r\n            value={codigoProducto}\r\n            onChange={(e) => setCodigoProducto(e.target.value)}\r\n          />\r\n          <input\r\n            type=\"number\"\r\n            placeholder=\"Cantidad\"\r\n            value={cantidadProducto}\r\n            onChange={(e) => setCantidadProducto(e.target.value)}\r\n            min=\"1\"\r\n            className=\"input-cantidad\"\r\n          />\r\n          <button onClick={agregarProducto} className=\"btn-agregar\">\r\n            ‚ûï Agregar\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Secci√≥n 3: Tabla de Productos */}\r\n      {productosSeleccionados.length > 0 && (\r\n        <div className=\"seccion-venta\">\r\n          <h3>üõí Productos Seleccionados</h3>\r\n          <table className=\"tabla-productos-venta\">\r\n            <thead>\r\n              <tr>\r\n                <th>C√≥digo</th>\r\n                <th>Producto</th>\r\n                <th>Precio Unit.</th>\r\n                <th>Cantidad</th>\r\n                <th>Subtotal</th>\r\n                <th>Acci√≥n</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {productosSeleccionados.map((producto) => (\r\n                <tr key={producto.id_producto}>\r\n                  <td>{producto.id_producto}</td>\r\n                  <td>{producto.nombre}</td>\r\n                  <td>S/ {producto.precio.toFixed(2)}</td>\r\n                  <td>\r\n                    <input\r\n                      type=\"number\"\r\n                      value={producto.cantidadVendida}\r\n                      onChange={(e) => actualizarCantidad(producto.id_producto, e.target.value)}\r\n                      min=\"1\"\r\n                      max={producto.cantidad}\r\n                      className=\"input-cantidad-tabla\"\r\n                    />\r\n                  </td>\r\n                  <td>S/ {producto.subtotalProducto.toFixed(2)}</td>\r\n                  <td>\r\n                    <button \r\n                      onClick={() => eliminarProducto(producto.id_producto)} \r\n                      className=\"btn-eliminar\"\r\n                    >\r\n                      üóëÔ∏è\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      )}\r\n\r\n      {/* Secci√≥n 4: Totales y M√©todo de Pago */}\r\n      {productosSeleccionados.length > 0 && (\r\n        <div className=\"seccion-venta\">\r\n          <div className=\"totales-container\">\r\n            <div className=\"totales\">\r\n              <div className=\"fila-total\">\r\n                <span>Subtotal:</span>\r\n                <span>S/ {calcularSubtotal().toFixed(2)}</span>\r\n              </div>\r\n              <div className=\"fila-total\">\r\n                <span>IGV (18%):</span>\r\n                <span>S/ {calcularIGV().toFixed(2)}</span>\r\n              </div>\r\n              <div className=\"fila-total total-final\">\r\n                <span>TOTAL:</span>\r\n                <span>S/ {calcularTotal().toFixed(2)}</span>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"metodo-pago\">\r\n              <h4>üí≥ M√©todo de Pago</h4>\r\n              <div className=\"opciones-pago\">\r\n                <label>\r\n                  <input\r\n                    type=\"radio\"\r\n                    value=\"efectivo\"\r\n                    checked={metodoPago === \"efectivo\"}\r\n                    onChange={(e) => setMetodoPago(e.target.value)}\r\n                  />\r\n                  üíµ Efectivo\r\n                </label>\r\n                <label>\r\n                  <input\r\n                    type=\"radio\"\r\n                    value=\"tarjeta\"\r\n                    checked={metodoPago === \"tarjeta\"}\r\n                    onChange={(e) => setMetodoPago(e.target.value)}\r\n                  />\r\n                  üí≥ Tarjeta\r\n                </label>\r\n              </div>\r\n\r\n              <div className=\"opciones-moneda\">\r\n                <label>\r\n                  <input\r\n                    type=\"radio\"\r\n                    value=\"PEN\"\r\n                    checked={moneda === \"PEN\"}\r\n                    onChange={(e) => {\r\n                      setMoneda(e.target.value);\r\n                      setTipoCambio(null);\r\n                    }}\r\n                  />\r\n                  üáµüá™ Soles (PEN)\r\n                </label>\r\n                <label>\r\n                  <input\r\n                    type=\"radio\"\r\n                    value=\"USD\"\r\n                    checked={moneda === \"USD\"}\r\n                    onChange={(e) => {\r\n                      setMoneda(e.target.value);\r\n                      obtenerTipoCambio();\r\n                    }}\r\n                  />\r\n                  üíµ D√≥lares (USD)\r\n                </label>\r\n              </div>\r\n\r\n              {moneda === \"USD\" && tipoCambio && (\r\n                <div className=\"tipo-cambio-info\">\r\n                  <p><strong>‚ö†Ô∏è Tipo de cambio:</strong> $1 USD = S/ {tipoCambio.toFixed(2)} PEN</p>\r\n                  <p><em>Los totales se mostrar√°n en Soles (requerimiento SUNAT)</em></p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          <button \r\n            onClick={generarFacturaVenta} \r\n            className=\"btn-generar-factura\"\r\n            disabled={loadingFactura}\r\n          >\r\n            {loadingFactura \r\n              ? \"‚è≥ Guardando...\" \r\n              : (clienteSeleccionado \r\n                  ? \"üßæ Generar Boleta\" \r\n                  : \"üìÑ Generar Factura\")}\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VentasForm;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,QAAQ,OAAO;AACvC,SAASC,WAAW,QAAQ,sBAAsB;AAClD,SAASC,WAAW,QAAQ,sBAAsB;AAClD,SAASC,WAAW,QAAQ,sBAAsB,CAAC,CAAC;AACpD,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAO,kBAAkB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE1B,MAAMC,UAAU,GAAGA,CAAC;EAAEC,SAAS;EAAEC,mBAAmB;EAAEC;AAAe,CAAC,KAAK;EAAAC,EAAA;EACzE;EACA,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAGb,QAAQ,CAAC,SAAS,CAAC;EACzD,MAAM,CAACc,GAAG,EAAEC,MAAM,CAAC,GAAGf,QAAQ,CAAC,EAAE,CAAC;EAClC,MAAM,CAACgB,GAAG,EAAEC,MAAM,CAAC,GAAGjB,QAAQ,CAAC,EAAE,CAAC;EAClC,MAAM,CAACkB,mBAAmB,EAAEC,sBAAsB,CAAC,GAAGnB,QAAQ,CAAC,IAAI,CAAC;EACpE,MAAM,CAACoB,mBAAmB,EAAEC,sBAAsB,CAAC,GAAGrB,QAAQ,CAAC,IAAI,CAAC;;EAEpE;EACA,MAAM;IAAEsB,mBAAmB;IAAEC,sBAAsB;IAAEC,OAAO,EAAEC;EAAe,CAAC,GAAGxB,WAAW,CAAC,CAAC;EAC9F,MAAM;IAAEyB,mBAAmB;IAAEF,OAAO,EAAEG,cAAc;IAAEC,KAAK,EAAEC;EAAa,CAAC,GAAG1B,WAAW,CAAC,CAAC;EAC3F,MAAM;IAAE2B,cAAc;IAAEC,wBAAwB;IAAEP,OAAO,EAAEQ,cAAc;IAAEJ,KAAK,EAAEK;EAAa,CAAC,GAAG/B,WAAW,CAAC,CAAC;;EAEhH;EACA,MAAM,CAACgC,cAAc,EAAEC,iBAAiB,CAAC,GAAGnC,QAAQ,CAAC,EAAE,CAAC;EACxD,MAAM,CAACoC,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGrC,QAAQ,CAAC,CAAC,CAAC;EAC3D,MAAM,CAACsC,sBAAsB,EAAEC,yBAAyB,CAAC,GAAGvC,QAAQ,CAAC,EAAE,CAAC;;EAExE;EACA,MAAM,CAACwC,UAAU,EAAEC,aAAa,CAAC,GAAGzC,QAAQ,CAAC,UAAU,CAAC;EACxD,MAAM,CAAC0C,MAAM,EAAEC,SAAS,CAAC,GAAG3C,QAAQ,CAAC,KAAK,CAAC;EAC3C,MAAM,CAAC4C,UAAU,EAAEC,aAAa,CAAC,GAAG7C,QAAQ,CAAC,IAAI,CAAC;;EAElD;EACA,MAAM8C,aAAa,GAAG,MAAAA,CAAA,KAAY;IAChC,IAAI,CAAChC,GAAG,EAAE;MACRiC,KAAK,CAAC,4CAA4C,CAAC;MACnD;IACF;IAEA,MAAMC,QAAQ,GAAGlC,GAAG,CAACmC,WAAW,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC;IAEzC,IAAI;MACF;MACA,IAAIF,QAAQ,CAACG,MAAM,KAAK,CAAC,IAAI,OAAO,CAACC,IAAI,CAACJ,QAAQ,CAAC,EAAE;QACnD;QACA,MAAMK,cAAc,GAAG,MAAM9B,sBAAsB,CAACyB,QAAQ,CAAC;QAE7D,IAAIK,cAAc,IAAIA,cAAc,CAACF,MAAM,GAAG,CAAC,EAAE;UAC/ChC,sBAAsB,CAAC;YACrBmC,UAAU,EAAED,cAAc,CAAC,CAAC,CAAC,CAACC,UAAU;YACxCxC,GAAG,EAAEuC,cAAc,CAAC,CAAC,CAAC,CAACvC,GAAG;YAC1ByC,cAAc,EAAEF,cAAc,CAAC,CAAC,CAAC,CAACG,eAAe;YACjDC,OAAO,EAAEJ,cAAc,CAAC,CAAC,CAAC,CAACI,OAAO;YAClCC,eAAe,EAAEL,cAAc,CAAC,CAAC,CAAC,CAACM,gBAAgB;YACnDC,eAAe,EAAEP,cAAc,CAAC,CAAC,CAAC,CAACQ;UACrC,CAAC,CAAC;UACF;QACF;;QAEA;QACA,MAAMC,aAAa,GAAG,MAAMxC,mBAAmB,CAAC0B,QAAQ,CAAC;QACzDD,KAAK,CAAC,gHAAgH,CAAC;QACvH5B,sBAAsB,CAAC,IAAI,CAAC;QAC5B;MACF;;MAEA;MACA;MACA,MAAM4C,QAAQ,GAAG,MAAM3D,KAAK,CAAC4D,GAAG,CAAC,oCAAoC,CAAC;MACtE,MAAMC,gBAAgB,GAAGF,QAAQ,CAACG,IAAI;;MAEtC;MACA,MAAMC,iBAAiB,GAAGF,gBAAgB,CAACG,IAAI,CAACC,CAAC,IAC9CA,CAAC,CAACb,eAAe,IAAIa,CAAC,CAACb,eAAe,CAACP,WAAW,CAAC,CAAC,CAACqB,QAAQ,CAACtB,QAAQ,CAAC,IACvEqB,CAAC,CAACZ,OAAO,IAAIY,CAAC,CAACZ,OAAO,CAACR,WAAW,CAAC,CAAC,CAACqB,QAAQ,CAACtB,QAAQ,CAAE,IACxDqB,CAAC,CAACV,gBAAgB,IAAIU,CAAC,CAACV,gBAAgB,CAACV,WAAW,CAAC,CAAC,CAACqB,QAAQ,CAACtB,QAAQ,CAAE,IAC1EqB,CAAC,CAACR,gBAAgB,IAAIQ,CAAC,CAACR,gBAAgB,CAACZ,WAAW,CAAC,CAAC,CAACqB,QAAQ,CAACtB,QAAQ,CAC3E,CAAC;MAED,IAAImB,iBAAiB,EAAE;QACrBhD,sBAAsB,CAAC;UACrBmC,UAAU,EAAEa,iBAAiB,CAACb,UAAU;UACxCxC,GAAG,EAAEqD,iBAAiB,CAACrD,GAAG;UAC1ByC,cAAc,EAAEY,iBAAiB,CAACX,eAAe;UACjDC,OAAO,EAAEU,iBAAiB,CAACV,OAAO;UAClCC,eAAe,EAAES,iBAAiB,CAACR,gBAAgB;UACnDC,eAAe,EAAEO,iBAAiB,CAACN;QACrC,CAAC,CAAC;QACF;MACF;;MAEA;MACAd,KAAK,CAAC,wCAAwCjC,GAAG,8EAA8E,CAAC;MAChIK,sBAAsB,CAAC,IAAI,CAAC;IAE9B,CAAC,CAAC,OAAOoD,GAAG,EAAE;MACZC,OAAO,CAAC5C,KAAK,CAAC,0BAA0B,EAAE2C,GAAG,CAAC;MAC9CxB,KAAK,CAAC,iEAAiE,CAAC;MACxE5B,sBAAsB,CAAC,IAAI,CAAC;IAC9B;EACF,CAAC;;EAED;EACA,MAAMsD,aAAa,GAAG,MAAAA,CAAA,KAAY;IAChC,IAAI,CAACzD,GAAG,IAAIA,GAAG,CAACmC,MAAM,KAAK,EAAE,EAAE;MAC7BJ,KAAK,CAAC,oCAAoC,CAAC;MAC3C;IACF;IAEA,IAAI;MACF;MACA,IAAI;QACF,MAAM2B,eAAe,GAAG,MAAMtE,KAAK,CAAC4D,GAAG,CAAC,0CAA0ChD,GAAG,EAAE,CAAC;QAExF,IAAI0D,eAAe,CAACR,IAAI,EAAE;UACxB,MAAMS,OAAO,GAAGD,eAAe,CAACR,IAAI;UACpC7C,sBAAsB,CAAC;YACrBuD,UAAU,EAAED,OAAO,CAACC,UAAU;YAC9B5D,GAAG,EAAE2D,OAAO,CAAC3D,GAAG;YAChB6D,WAAW,EAAEF,OAAO,CAACG,YAAY;YACjCC,SAAS,EAAEJ,OAAO,CAACI,SAAS,IAAI,GAAG;YACnCC,MAAM,EAAEL,OAAO,CAACK,MAAM,IAAI,QAAQ;YAClCC,SAAS,EAAEN,OAAO,CAACM,SAAS,IAAI,QAAQ;YACxCC,YAAY,EAAEP,OAAO,CAACO,YAAY,IAAI,GAAG;YACzCC,SAAS,EAAER,OAAO,CAACQ,SAAS,IAAI,GAAG;YACnCC,QAAQ,EAAET,OAAO,CAACS,QAAQ,IAAI,GAAG;YACjCC,MAAM,EAAEV,OAAO,CAACU,MAAM,IAAI;UAC5B,CAAC,CAAC;UACFtC,KAAK,CAAC,oCAAoC,CAAC;UAC3C;QACF;MACF,CAAC,CAAC,OAAOuC,YAAY,EAAE;QAAA,IAAAC,qBAAA;QACrB;QACA;QACA,IAAI,EAAAA,qBAAA,GAAAD,YAAY,CAACvB,QAAQ,cAAAwB,qBAAA,uBAArBA,qBAAA,CAAuBC,MAAM,MAAK,GAAG,EAAE;UACzChB,OAAO,CAAC5C,KAAK,CAAC,6BAA6B,EAAE0D,YAAY,CAAC;QAC5D;QACA;MACF;;MAEA;MACA,MAAMG,YAAY,GAAG,MAAM/D,mBAAmB,CAACV,GAAG,CAAC;MAEnD,IAAIyE,YAAY,EAAE;QAChB;QACA,IAAI;UACF,MAAMC,WAAW,GAAG;YAClB1E,GAAG,EAAEyE,YAAY,CAACzE,GAAG;YACrB8D,YAAY,EAAEW,YAAY,CAACZ,WAAW;YACtCE,SAAS,EAAEU,YAAY,CAACV,SAAS,IAAI,GAAG;YACxCG,YAAY,EAAEO,YAAY,CAACP,YAAY,IAAI,GAAG;YAC9CC,SAAS,EAAEM,YAAY,CAACN,SAAS,IAAI,GAAG;YACxCC,QAAQ,EAAEK,YAAY,CAACL,QAAQ,IAAI,GAAG;YACtCJ,MAAM,EAAES,YAAY,CAACT,MAAM,IAAI,QAAQ;YACvCC,SAAS,EAAEQ,YAAY,CAACR,SAAS,IAAI;UACvC,CAAC;UAED,MAAMU,gBAAgB,GAAG,MAAMvF,KAAK,CAACwF,IAAI,CAAC,oCAAoC,EAAEF,WAAW,CAAC;;UAE5F;UACArE,sBAAsB,CAAC;YACrBuD,UAAU,EAAEe,gBAAgB,CAACzB,IAAI,CAACU,UAAU;YAC5C5D,GAAG,EAAEyE,YAAY,CAACzE,GAAG;YACrB6D,WAAW,EAAEY,YAAY,CAACZ,WAAW;YACrCE,SAAS,EAAEU,YAAY,CAACV,SAAS;YACjCC,MAAM,EAAES,YAAY,CAACT,MAAM;YAC3BC,SAAS,EAAEQ,YAAY,CAACR,SAAS;YACjCC,YAAY,EAAEO,YAAY,CAACP,YAAY,IAAI,GAAG;YAC9CC,SAAS,EAAEM,YAAY,CAACN,SAAS,IAAI,GAAG;YACxCC,QAAQ,EAAEK,YAAY,CAACL,QAAQ,IAAI,GAAG;YACtCC,MAAM,EAAEI,YAAY,CAACJ,MAAM,IAAI;UACjC,CAAC,CAAC;UAEFtC,KAAK,CAAC,4DAA4D,CAAC;UACnE,OAAO,CAAC;QACV,CAAC,CAAC,OAAO8C,aAAa,EAAE;UAAA,IAAAC,qBAAA;UACtB;UACA,IAAI,EAAAA,qBAAA,GAAAD,aAAa,CAAC9B,QAAQ,cAAA+B,qBAAA,uBAAtBA,qBAAA,CAAwBN,MAAM,MAAK,GAAG,EAAE;YAC1C;YACA,MAAMd,eAAe,GAAG,MAAMtE,KAAK,CAAC4D,GAAG,CAAC,0CAA0ChD,GAAG,EAAE,CAAC;YACxF,IAAI0D,eAAe,CAACR,IAAI,EAAE;cACxB7C,sBAAsB,CAAC;gBACrBuD,UAAU,EAAEF,eAAe,CAACR,IAAI,CAACU,UAAU;gBAC3C5D,GAAG,EAAE0D,eAAe,CAACR,IAAI,CAAClD,GAAG;gBAC7B6D,WAAW,EAAEH,eAAe,CAACR,IAAI,CAACY,YAAY;gBAC9CC,SAAS,EAAEL,eAAe,CAACR,IAAI,CAACa,SAAS;gBACzCC,MAAM,EAAEN,eAAe,CAACR,IAAI,CAACc,MAAM;gBACnCC,SAAS,EAAEP,eAAe,CAACR,IAAI,CAACe,SAAS;gBACzCC,YAAY,EAAER,eAAe,CAACR,IAAI,CAACgB,YAAY,IAAI,GAAG;gBACtDC,SAAS,EAAET,eAAe,CAACR,IAAI,CAACiB,SAAS,IAAI,GAAG;gBAChDC,QAAQ,EAAEV,eAAe,CAACR,IAAI,CAACkB,QAAQ,IAAI,GAAG;gBAC9CC,MAAM,EAAEX,eAAe,CAACR,IAAI,CAACmB,MAAM,IAAI;cACzC,CAAC,CAAC;cACFtC,KAAK,CAAC,oCAAoC,CAAC;cAC3C,OAAO,CAAC;YACV;UACF,CAAC,MAAM;YACL;YACA,MAAM8C,aAAa;UACrB;QACF;MACF,CAAC,MAAM;QACL9C,KAAK,CAAC,kDAAkD,CAAC;QACzD1B,sBAAsB,CAAC,IAAI,CAAC;MAC9B;IACF,CAAC,CAAC,OAAOkD,GAAG,EAAE;MACZ;MACAC,OAAO,CAAC5C,KAAK,CAAC,0BAA0B,EAAE2C,GAAG,CAAC;MAC9CxB,KAAK,CAAC,YAAYwB,GAAG,CAACwB,OAAO,IAAI,iCAAiC,EAAE,CAAC;MACrE1E,sBAAsB,CAAC,IAAI,CAAC;IAC9B;EACF,CAAC;;EAED;EACA,MAAM2E,iBAAiB,GAAG,MAAAA,CAAA,KAAY;IACpC;IACA,IAAIpD,UAAU,EAAE;MACd,OAAOA,UAAU;IACnB;;IAEA;IACA,IAAI;MACF,MAAMmB,QAAQ,GAAG,MAAM3D,KAAK,CAAC4D,GAAG,CAAC,gEAAgE,CAAC;MAClG,MAAMiC,UAAU,GAAGlC,QAAQ,CAACG,IAAI,CAACgC,MAAM,IAAI,IAAI;MAC/CrD,aAAa,CAACoD,UAAU,CAAC;MACzB,OAAOA,UAAU;IACnB,CAAC,CAAC,OAAO1B,GAAG,EAAE;MACZC,OAAO,CAAC5C,KAAK,CAAC,kCAAkC,EAAE2C,GAAG,CAAC;MACtDxB,KAAK,CAAC,+DAA+D,CAAC;MACtEF,aAAa,CAAC,IAAI,CAAC;MACnB,OAAO,IAAI;IACb;EACF,CAAC;;EAED;EACA,MAAMsD,eAAe,GAAGA,CAAA,KAAM;IAC5B,IAAI,CAACjE,cAAc,EAAE;MACnBa,KAAK,CAAC,+BAA+B,CAAC;MACtC;IACF;IAEA,MAAMqD,QAAQ,GAAG5F,SAAS,CAAC4D,IAAI,CAACiC,CAAC,IAC/BC,MAAM,CAACD,CAAC,CAACE,WAAW,CAAC,CAACtD,WAAW,CAAC,CAAC,CAACqB,QAAQ,CAACpC,cAAc,CAACe,WAAW,CAAC,CAAC,CAAC,IAC1EoD,CAAC,CAACG,MAAM,CAACvD,WAAW,CAAC,CAAC,CAACqB,QAAQ,CAACpC,cAAc,CAACe,WAAW,CAAC,CAAC,CAC9D,CAAC;IAED,IAAI,CAACmD,QAAQ,EAAE;MACbrD,KAAK,CAAC,wBAAwB,CAAC;MAC/B;IACF;;IAEA;IACA,IAAIqD,QAAQ,CAACK,QAAQ,GAAGrE,gBAAgB,EAAE;MACxCW,KAAK,CAAC,gCAAgCqD,QAAQ,CAACK,QAAQ,uBAAuB,CAAC;MAC/E;IACF;IAEA,MAAMC,MAAM,GAAGpE,sBAAsB,CAAC8B,IAAI,CAACiC,CAAC,IAAIA,CAAC,CAACE,WAAW,KAAKH,QAAQ,CAACG,WAAW,CAAC;IACvF,IAAIG,MAAM,EAAE;MACV3D,KAAK,CAAC,oEAAoE,CAAC;MAC3E;IACF;IAEA,MAAM4D,mBAAmB,GAAG;MAC1B,GAAGP,QAAQ;MACXQ,eAAe,EAAEC,QAAQ,CAACzE,gBAAgB,CAAC;MAC3C0E,gBAAgB,EAAEV,QAAQ,CAACW,MAAM,GAAGF,QAAQ,CAACzE,gBAAgB;IAC/D,CAAC;IAEDG,yBAAyB,CAAC,CAAC,GAAGD,sBAAsB,EAAEqE,mBAAmB,CAAC,CAAC;IAC3ExE,iBAAiB,CAAC,EAAE,CAAC;IACrBE,mBAAmB,CAAC,CAAC,CAAC;EACxB,CAAC;;EAED;EACA,MAAM2E,gBAAgB,GAAIT,WAAW,IAAK;IACxChE,yBAAyB,CAACD,sBAAsB,CAAC2E,MAAM,CAACZ,CAAC,IAAIA,CAAC,CAACE,WAAW,KAAKA,WAAW,CAAC,CAAC;EAC9F,CAAC;;EAED;EACA,MAAMW,kBAAkB,GAAGA,CAACX,WAAW,EAAEY,aAAa,KAAK;IACzD,IAAIA,aAAa,GAAG,CAAC,EAAE;;IAEvB;IACA,MAAMf,QAAQ,GAAG5F,SAAS,CAAC4D,IAAI,CAACiC,CAAC,IAAIA,CAAC,CAACE,WAAW,KAAKA,WAAW,CAAC;IACnE,IAAIH,QAAQ,IAAIe,aAAa,GAAGf,QAAQ,CAACK,QAAQ,EAAE;MACjD1D,KAAK,CAAC,gCAAgCqD,QAAQ,CAACK,QAAQ,uBAAuB,CAAC;MAC/E;IACF;IAEAlE,yBAAyB,CAACD,sBAAsB,CAAC8E,GAAG,CAACf,CAAC,IACpDA,CAAC,CAACE,WAAW,KAAKA,WAAW,GACzB;MAAE,GAAGF,CAAC;MAAEO,eAAe,EAAEC,QAAQ,CAACM,aAAa,CAAC;MAAEL,gBAAgB,EAAET,CAAC,CAACU,MAAM,GAAGF,QAAQ,CAACM,aAAa;IAAE,CAAC,GACxGd,CACN,CAAC,CAAC;EACJ,CAAC;;EAED;EACA,MAAMgB,gBAAgB,GAAGA,CAAA,KAAM;IAC7B,OAAO/E,sBAAsB,CAACgF,MAAM,CAAC,CAACC,KAAK,EAAElB,CAAC,KAAKkB,KAAK,GAAGlB,CAAC,CAACS,gBAAgB,EAAE,CAAC,CAAC;EACnF,CAAC;EAED,MAAMU,WAAW,GAAGA,CAAA,KAAM;IACxB,OAAOH,gBAAgB,CAAC,CAAC,GAAG,IAAI;EAClC,CAAC;EAED,MAAMI,aAAa,GAAGA,CAAA,KAAM;IAC1B,OAAOJ,gBAAgB,CAAC,CAAC,GAAGG,WAAW,CAAC,CAAC;EAC3C,CAAC;;EAED;EACA,MAAME,mBAAmB,GAAG,MAAAA,CAAA,KAAY;IACtC;IACA,IAAI,CAACxG,mBAAmB,IAAI,CAACE,mBAAmB,EAAE;MAChD2B,KAAK,CAAC,uCAAuC,CAAC;MAC9C;IACF;IAEA,IAAIT,sBAAsB,CAACa,MAAM,KAAK,CAAC,EAAE;MACvCJ,KAAK,CAAC,mCAAmC,CAAC;MAC1C;IACF;;IAEA;IACA,IAAI4E,MAAM,GAAG,CAAC;IACd,IAAIjF,MAAM,KAAK,KAAK,EAAE;MACpBiF,MAAM,GAAG,MAAM3B,iBAAiB,CAAC,CAAC;;MAElC;MACA,IAAI,CAAC2B,MAAM,IAAIC,KAAK,CAACD,MAAM,CAAC,EAAE;QAC5B5E,KAAK,CAAC,0DAA0D,CAAC;QACjE;MACF;IACF;IAEA,MAAM8E,cAAc,GAAGR,gBAAgB,CAAC,CAAC;IACzC,MAAMS,aAAa,GAAGpF,MAAM,KAAK,KAAK,GAAGmF,cAAc,GAAGF,MAAM,GAAGE,cAAc;IACjF,MAAME,QAAQ,GAAGD,aAAa,GAAG,IAAI;IACrC,MAAME,UAAU,GAAGF,aAAa,GAAGC,QAAQ;;IAE3C;IACA,MAAME,eAAe,GAAG/G,mBAAmB,GAAG,QAAQ,GAAG,SAAS;;IAElE;IACA,MAAMgH,MAAM,GAAGnG,wBAAwB,CAACkG,eAAe,CAAC;;IAExD;IACA,IAAIA,eAAe,KAAK,QAAQ,IAAI,EAAC/G,mBAAmB,aAAnBA,mBAAmB,eAAnBA,mBAAmB,CAAEoC,UAAU,GAAE;MACpEP,KAAK,CAAC,kDAAkD,CAAC;MACzD;IACF;;IAEA;IACA,IAAIkF,eAAe,KAAK,SAAS,IAAI,EAAC7G,mBAAmB,aAAnBA,mBAAmB,eAAnBA,mBAAmB,CAAEwD,UAAU,GAAE;MACrE7B,KAAK,CAAC,6GAA6G,CAAC;MACpH;IACF;;IAEA;IACA,MAAMoF,WAAW,GAAG;MAClBF,eAAe;MACfC,MAAM;MACNE,QAAQ,EAAEC,UAAU,CAACP,aAAa,CAACQ,OAAO,CAAC,CAAC,CAAC,CAAC;MAC9CC,GAAG,EAAEF,UAAU,CAACN,QAAQ,CAACO,OAAO,CAAC,CAAC,CAAC,CAAC;MACpCf,KAAK,EAAEc,UAAU,CAACL,UAAU,CAACM,OAAO,CAAC,CAAC,CAAC,CAAC;MACxC9F,UAAU,EAAEA,UAAU,CAACgG,WAAW,CAAC,CAAC;MACpC9F,MAAM,EAAEA,MAAM;MAAE;MAChB+F,WAAW,EAAE/F,MAAM,KAAK,KAAK,GAAG2F,UAAU,CAACV,MAAM,CAACW,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI;MACpEhF,UAAU,EAAE,CAAApC,mBAAmB,aAAnBA,mBAAmB,uBAAnBA,mBAAmB,CAAEoC,UAAU,KAAI,IAAI;MAAE;MACrDsB,UAAU,EAAE,CAAAxD,mBAAmB,aAAnBA,mBAAmB,uBAAnBA,mBAAmB,CAAEwD,UAAU,KAAI,IAAI;MAAE;MACrDpE,SAAS,EAAE8B,sBAAsB,CAAC8E,GAAG,CAACf,CAAC,KAAK;QAC1CE,WAAW,EAAEF,CAAC,CAACE,WAAW;QAC1BK,eAAe,EAAEP,CAAC,CAACO,eAAe;QAClCG,MAAM,EAAEV,CAAC,CAACU,MAAM;QAChBD,gBAAgB,EAAET,CAAC,CAACS;MACtB,CAAC,CAAC;IACJ,CAAC;IAED,IAAI;MACF;MACA,MAAM4B,eAAe,GAAG,MAAM5G,cAAc,CAACqG,WAAW,CAAC;MAEzDpF,KAAK,CAAC,KAAKkF,eAAe,IAAIC,MAAM,+CAA+C,CAAC;;MAEpF;MACA,IAAIxH,cAAc,EAAE;QAClB,MAAMiI,mBAAmB,GAAG;UAC1BC,EAAE,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC;UACdC,KAAK,EAAE,IAAIF,IAAI,CAAC,CAAC,CAACG,cAAc,CAAC,CAAC;UAClCf,eAAe,EAAEA,eAAe;UAChCgB,OAAO,EAAE/H,mBAAmB,IAAI,IAAI;UACpCyD,OAAO,EAAEvD,mBAAmB,IAAI,IAAI;UACpCZ,SAAS,EAAE8B,sBAAsB;UACjC8F,QAAQ,EAAEN,aAAa,CAACQ,OAAO,CAAC,CAAC,CAAC;UAClCC,GAAG,EAAER,QAAQ,CAACO,OAAO,CAAC,CAAC,CAAC;UACxBf,KAAK,EAAES,UAAU,CAACM,OAAO,CAAC,CAAC,CAAC;UAC5B9F,UAAU,EAAEA,UAAU;UACtB0G,cAAc,EAAExG,MAAM;UACtBE,UAAU,EAAEF,MAAM,KAAK,KAAK,GAAGiF,MAAM,CAACW,OAAO,CAAC,CAAC,CAAC,GAAG,IAAI;UACvD5F,MAAM,EAAEA;QACV,CAAC;QACDhC,cAAc,CAACiI,mBAAmB,CAAC;MACrC;;MAEA;MACAQ,iBAAiB,CAAC,CAAC;IACrB,CAAC,CAAC,OAAO5E,GAAG,EAAE;MAAA,IAAA6E,aAAA,EAAAC,kBAAA;MACZtG,KAAK,CAAC,gCAAgCd,YAAY,MAAAmH,aAAA,GAAI7E,GAAG,CAACR,QAAQ,cAAAqF,aAAA,wBAAAC,kBAAA,GAAZD,aAAA,CAAclF,IAAI,cAAAmF,kBAAA,uBAAlBA,kBAAA,CAAoBtD,OAAO,KAAIxB,GAAG,CAACwB,OAAO,EAAE,CAAC;IACrG;EACF,CAAC;EAED,MAAMoD,iBAAiB,GAAGA,CAAA,KAAM;IAC9BtI,cAAc,CAAC,SAAS,CAAC;IACzBE,MAAM,CAAC,EAAE,CAAC;IACVE,MAAM,CAAC,EAAE,CAAC;IACVE,sBAAsB,CAAC,IAAI,CAAC;IAC5BE,sBAAsB,CAAC,IAAI,CAAC;IAC5Bc,iBAAiB,CAAC,EAAE,CAAC;IACrBE,mBAAmB,CAAC,CAAC,CAAC;IACtBE,yBAAyB,CAAC,EAAE,CAAC;IAC7BE,aAAa,CAAC,UAAU,CAAC;IACzBE,SAAS,CAAC,KAAK,CAAC;IAChBE,aAAa,CAAC,IAAI,CAAC;EACrB,CAAC;EAED,oBACEvC,OAAA;IAAKgJ,SAAS,EAAC,kBAAkB;IAAAC,QAAA,gBAC/BjJ,OAAA;MAAAiJ,QAAA,EAAI;IAAkB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,EAG1B1H,YAAY,iBACX3B,OAAA;MAAKgJ,SAAS,EAAC,eAAe;MAACM,KAAK,EAAE;QACpCC,UAAU,EAAE,MAAM;QAClBC,KAAK,EAAE,MAAM;QACbC,OAAO,EAAE,MAAM;QACfC,YAAY,EAAE,KAAK;QACnBC,YAAY,EAAE;MAChB,CAAE;MAAAV,QAAA,GAAC,eACE,EAACtH,YAAY;IAAA;MAAAuH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACb,CACN,eAGDrJ,OAAA;MAAKgJ,SAAS,EAAC,eAAe;MAAAC,QAAA,gBAC5BjJ,OAAA;QAAAiJ,QAAA,EAAI;MAA2B;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAGpCrJ,OAAA;QAAKgJ,SAAS,EAAC,uBAAuB;QAAAC,QAAA,gBACpCjJ,OAAA;UAAAiJ,QAAA,gBACEjJ,OAAA;YACE4J,IAAI,EAAC,OAAO;YACZC,KAAK,EAAC,SAAS;YACfC,OAAO,EAAExJ,WAAW,KAAK,SAAU;YACnCyJ,QAAQ,EAAGC,CAAC,IAAK;cACfzJ,cAAc,CAACyJ,CAAC,CAACC,MAAM,CAACJ,KAAK,CAAC;cAC9B9I,sBAAsB,CAAC,IAAI,CAAC;cAC5BF,sBAAsB,CAAC,IAAI,CAAC;cAC5BF,MAAM,CAAC,EAAE,CAAC;cACVF,MAAM,CAAC,EAAE,CAAC;YACZ;UAAE;YAAAyI,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,sCAEJ;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACRrJ,OAAA;UAAAiJ,QAAA,gBACEjJ,OAAA;YACE4J,IAAI,EAAC,OAAO;YACZC,KAAK,EAAC,SAAS;YACfC,OAAO,EAAExJ,WAAW,KAAK,SAAU;YACnCyJ,QAAQ,EAAGC,CAAC,IAAK;cACfzJ,cAAc,CAACyJ,CAAC,CAACC,MAAM,CAACJ,KAAK,CAAC;cAC9B9I,sBAAsB,CAAC,IAAI,CAAC;cAC5BF,sBAAsB,CAAC,IAAI,CAAC;cAC5BF,MAAM,CAAC,EAAE,CAAC;cACVF,MAAM,CAAC,EAAE,CAAC;YACZ;UAAE;YAAAyI,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,8BAEJ;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL,CAAC,EAGL/I,WAAW,KAAK,SAAS,iBACxBN,OAAA;QAAKgJ,SAAS,EAAC,mBAAmB;QAAAC,QAAA,gBAChCjJ,OAAA;UACE4J,IAAI,EAAC,MAAM;UACXM,WAAW,EAAC,oCAAoC;UAChDL,KAAK,EAAErJ,GAAI;UACXuJ,QAAQ,EAAGC,CAAC,IAAKvJ,MAAM,CAACuJ,CAAC,CAACC,MAAM,CAACJ,KAAK;QAAE;UAAAX,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACzC,CAAC,eACFrJ,OAAA;UAAQmK,OAAO,EAAE3H,aAAc;UAACwG,SAAS,EAAC,YAAY;UAACoB,QAAQ,EAAEjJ,cAAe;UAAA8H,QAAA,EAC7E9H,cAAc,GAAG,aAAa,GAAG;QAAW;UAAA+H,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACvC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CACN,EAGA/I,WAAW,KAAK,SAAS,iBACxBN,OAAA;QAAKgJ,SAAS,EAAC,mBAAmB;QAAAC,QAAA,gBAChCjJ,OAAA;UACE4J,IAAI,EAAC,MAAM;UACXM,WAAW,EAAC,6BAA0B;UACtCL,KAAK,EAAEnJ,GAAI;UACXqJ,QAAQ,EAAGC,CAAC,IAAKrJ,MAAM,CAACqJ,CAAC,CAACC,MAAM,CAACJ,KAAK,CAACQ,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAACC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAE;UACxEC,SAAS,EAAC;QAAI;UAAArB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACf,CAAC,eACFrJ,OAAA;UAAQmK,OAAO,EAAEhG,aAAc;UAAC6E,SAAS,EAAC,YAAY;UAACoB,QAAQ,EAAE/I,cAAe;UAAA4H,QAAA,EAC7E5H,cAAc,GAAG,aAAa,GAAG;QAAW;UAAA6H,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACvC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CACN,EAGAzI,mBAAmB,iBAClBZ,OAAA;QAAKgJ,SAAS,EAAC,sBAAsB;QAAAC,QAAA,gBACnCjJ,OAAA;UAAAiJ,QAAA,gBAAGjJ,OAAA;YAAAiJ,QAAA,EAAQ;UAAQ;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,KAAC,EAACzI,mBAAmB,CAACqC,cAAc,IAAI,GAAGrC,mBAAmB,CAACuC,OAAO,IAAIvC,mBAAmB,CAACwC,eAAe,EAAE;QAAA;UAAA8F,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAChJrJ,OAAA;UAAAiJ,QAAA,gBAAGjJ,OAAA;YAAAiJ,QAAA,EAAQ;UAAI;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,KAAC,EAACzI,mBAAmB,CAACJ,GAAG;QAAA;UAAA0I,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACtDrJ,OAAA;UAAAiJ,QAAA,eAAGjJ,OAAA;YAAAiJ,QAAA,EAAI;UAAsB;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACnC,CACN,EAGAvI,mBAAmB,iBAClBd,OAAA;QAAKgJ,SAAS,EAAC,sBAAsB;QAAAC,QAAA,gBACnCjJ,OAAA;UAAAiJ,QAAA,gBAAGjJ,OAAA;YAAAiJ,QAAA,EAAQ;UAAQ;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,KAAC,EAACvI,mBAAmB,CAACyD,WAAW;QAAA;UAAA2E,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAClErJ,OAAA;UAAAiJ,QAAA,gBAAGjJ,OAAA;YAAAiJ,QAAA,EAAQ;UAAI;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,KAAC,EAACvI,mBAAmB,CAACJ,GAAG;QAAA;UAAAwI,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,EACrDvI,mBAAmB,CAAC2D,SAAS,iBAAIzE,OAAA;UAAAiJ,QAAA,gBAAGjJ,OAAA;YAAAiJ,QAAA,EAAQ;UAAU;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,KAAC,EAACvI,mBAAmB,CAAC2D,SAAS;QAAA;UAAAyE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,EACnGvI,mBAAmB,CAAC4D,MAAM,iBAAI1E,OAAA;UAAAiJ,QAAA,gBAAGjJ,OAAA;YAAAiJ,QAAA,EAAQ;UAAO;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,KAAC,EAACvI,mBAAmB,CAAC4D,MAAM;QAAA;UAAAwE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC3FrJ,OAAA;UAAAiJ,QAAA,eAAGjJ,OAAA;YAAAiJ,QAAA,EAAI;UAAwF;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACrG,CACN;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,eAGNrJ,OAAA;MAAKgJ,SAAS,EAAC,eAAe;MAAAC,QAAA,gBAC5BjJ,OAAA;QAAAiJ,QAAA,EAAI;MAAkB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC3BrJ,OAAA;QAAKgJ,SAAS,EAAC,mBAAmB;QAAAC,QAAA,gBAChCjJ,OAAA;UACE4J,IAAI,EAAC,MAAM;UACXM,WAAW,EAAC,iCAA8B;UAC1CL,KAAK,EAAEjI,cAAe;UACtBmI,QAAQ,EAAGC,CAAC,IAAKnI,iBAAiB,CAACmI,CAAC,CAACC,MAAM,CAACJ,KAAK;QAAE;UAAAX,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACpD,CAAC,eACFrJ,OAAA;UACE4J,IAAI,EAAC,QAAQ;UACbM,WAAW,EAAC,UAAU;UACtBL,KAAK,EAAE/H,gBAAiB;UACxBiI,QAAQ,EAAGC,CAAC,IAAKjI,mBAAmB,CAACiI,CAAC,CAACC,MAAM,CAACJ,KAAK,CAAE;UACrDW,GAAG,EAAC,GAAG;UACPxB,SAAS,EAAC;QAAgB;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC3B,CAAC,eACFrJ,OAAA;UAAQmK,OAAO,EAAEtE,eAAgB;UAACmD,SAAS,EAAC,aAAa;UAAAC,QAAA,EAAC;QAE1D;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,EAGLrH,sBAAsB,CAACa,MAAM,GAAG,CAAC,iBAChC7C,OAAA;MAAKgJ,SAAS,EAAC,eAAe;MAAAC,QAAA,gBAC5BjJ,OAAA;QAAAiJ,QAAA,EAAI;MAA0B;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACnCrJ,OAAA;QAAOgJ,SAAS,EAAC,uBAAuB;QAAAC,QAAA,gBACtCjJ,OAAA;UAAAiJ,QAAA,eACEjJ,OAAA;YAAAiJ,QAAA,gBACEjJ,OAAA;cAAAiJ,QAAA,EAAI;YAAM;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACfrJ,OAAA;cAAAiJ,QAAA,EAAI;YAAQ;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACjBrJ,OAAA;cAAAiJ,QAAA,EAAI;YAAY;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACrBrJ,OAAA;cAAAiJ,QAAA,EAAI;YAAQ;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACjBrJ,OAAA;cAAAiJ,QAAA,EAAI;YAAQ;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACjBrJ,OAAA;cAAAiJ,QAAA,EAAI;YAAM;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACb;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACA,CAAC,eACRrJ,OAAA;UAAAiJ,QAAA,EACGjH,sBAAsB,CAAC8E,GAAG,CAAEhB,QAAQ,iBACnC9F,OAAA;YAAAiJ,QAAA,gBACEjJ,OAAA;cAAAiJ,QAAA,EAAKnD,QAAQ,CAACG;YAAW;cAAAiD,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eAC/BrJ,OAAA;cAAAiJ,QAAA,EAAKnD,QAAQ,CAACI;YAAM;cAAAgD,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eAC1BrJ,OAAA;cAAAiJ,QAAA,GAAI,KAAG,EAACnD,QAAQ,CAACW,MAAM,CAACuB,OAAO,CAAC,CAAC,CAAC;YAAA;cAAAkB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eACxCrJ,OAAA;cAAAiJ,QAAA,eACEjJ,OAAA;gBACE4J,IAAI,EAAC,QAAQ;gBACbC,KAAK,EAAE/D,QAAQ,CAACQ,eAAgB;gBAChCyD,QAAQ,EAAGC,CAAC,IAAKpD,kBAAkB,CAACd,QAAQ,CAACG,WAAW,EAAE+D,CAAC,CAACC,MAAM,CAACJ,KAAK,CAAE;gBAC1EW,GAAG,EAAC,GAAG;gBACPC,GAAG,EAAE3E,QAAQ,CAACK,QAAS;gBACvB6C,SAAS,EAAC;cAAsB;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACjC;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACA,CAAC,eACLrJ,OAAA;cAAAiJ,QAAA,GAAI,KAAG,EAACnD,QAAQ,CAACU,gBAAgB,CAACwB,OAAO,CAAC,CAAC,CAAC;YAAA;cAAAkB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eAClDrJ,OAAA;cAAAiJ,QAAA,eACEjJ,OAAA;gBACEmK,OAAO,EAAEA,CAAA,KAAMzD,gBAAgB,CAACZ,QAAQ,CAACG,WAAW,CAAE;gBACtD+C,SAAS,EAAC,cAAc;gBAAAC,QAAA,EACzB;cAED;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACP,CAAC;UAAA,GAtBEvD,QAAQ,CAACG,WAAW;YAAAiD,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAuBzB,CACL;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACG,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CACN,EAGArH,sBAAsB,CAACa,MAAM,GAAG,CAAC,iBAChC7C,OAAA;MAAKgJ,SAAS,EAAC,eAAe;MAAAC,QAAA,gBAC5BjJ,OAAA;QAAKgJ,SAAS,EAAC,mBAAmB;QAAAC,QAAA,gBAChCjJ,OAAA;UAAKgJ,SAAS,EAAC,SAAS;UAAAC,QAAA,gBACtBjJ,OAAA;YAAKgJ,SAAS,EAAC,YAAY;YAAAC,QAAA,gBACzBjJ,OAAA;cAAAiJ,QAAA,EAAM;YAAS;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eACtBrJ,OAAA;cAAAiJ,QAAA,GAAM,KAAG,EAAClC,gBAAgB,CAAC,CAAC,CAACiB,OAAO,CAAC,CAAC,CAAC;YAAA;cAAAkB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC5C,CAAC,eACNrJ,OAAA;YAAKgJ,SAAS,EAAC,YAAY;YAAAC,QAAA,gBACzBjJ,OAAA;cAAAiJ,QAAA,EAAM;YAAU;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eACvBrJ,OAAA;cAAAiJ,QAAA,GAAM,KAAG,EAAC/B,WAAW,CAAC,CAAC,CAACc,OAAO,CAAC,CAAC,CAAC;YAAA;cAAAkB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACvC,CAAC,eACNrJ,OAAA;YAAKgJ,SAAS,EAAC,wBAAwB;YAAAC,QAAA,gBACrCjJ,OAAA;cAAAiJ,QAAA,EAAM;YAAM;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eACnBrJ,OAAA;cAAAiJ,QAAA,GAAM,KAAG,EAAC9B,aAAa,CAAC,CAAC,CAACa,OAAO,CAAC,CAAC,CAAC;YAAA;cAAAkB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACzC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eAENrJ,OAAA;UAAKgJ,SAAS,EAAC,aAAa;UAAAC,QAAA,gBAC1BjJ,OAAA;YAAAiJ,QAAA,EAAI;UAAiB;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eAC1BrJ,OAAA;YAAKgJ,SAAS,EAAC,eAAe;YAAAC,QAAA,gBAC5BjJ,OAAA;cAAAiJ,QAAA,gBACEjJ,OAAA;gBACE4J,IAAI,EAAC,OAAO;gBACZC,KAAK,EAAC,UAAU;gBAChBC,OAAO,EAAE5H,UAAU,KAAK,UAAW;gBACnC6H,QAAQ,EAAGC,CAAC,IAAK7H,aAAa,CAAC6H,CAAC,CAACC,MAAM,CAACJ,KAAK;cAAE;gBAAAX,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAChD,CAAC,yBAEJ;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACRrJ,OAAA;cAAAiJ,QAAA,gBACEjJ,OAAA;gBACE4J,IAAI,EAAC,OAAO;gBACZC,KAAK,EAAC,SAAS;gBACfC,OAAO,EAAE5H,UAAU,KAAK,SAAU;gBAClC6H,QAAQ,EAAGC,CAAC,IAAK7H,aAAa,CAAC6H,CAAC,CAACC,MAAM,CAACJ,KAAK;cAAE;gBAAAX,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAChD,CAAC,wBAEJ;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACL,CAAC,eAENrJ,OAAA;YAAKgJ,SAAS,EAAC,iBAAiB;YAAAC,QAAA,gBAC9BjJ,OAAA;cAAAiJ,QAAA,gBACEjJ,OAAA;gBACE4J,IAAI,EAAC,OAAO;gBACZC,KAAK,EAAC,KAAK;gBACXC,OAAO,EAAE1H,MAAM,KAAK,KAAM;gBAC1B2H,QAAQ,EAAGC,CAAC,IAAK;kBACf3H,SAAS,CAAC2H,CAAC,CAACC,MAAM,CAACJ,KAAK,CAAC;kBACzBtH,aAAa,CAAC,IAAI,CAAC;gBACrB;cAAE;gBAAA2G,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC,wCAEJ;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACRrJ,OAAA;cAAAiJ,QAAA,gBACEjJ,OAAA;gBACE4J,IAAI,EAAC,OAAO;gBACZC,KAAK,EAAC,KAAK;gBACXC,OAAO,EAAE1H,MAAM,KAAK,KAAM;gBAC1B2H,QAAQ,EAAGC,CAAC,IAAK;kBACf3H,SAAS,CAAC2H,CAAC,CAACC,MAAM,CAACJ,KAAK,CAAC;kBACzBnE,iBAAiB,CAAC,CAAC;gBACrB;cAAE;gBAAAwD,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC,iCAEJ;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACL,CAAC,EAELjH,MAAM,KAAK,KAAK,IAAIE,UAAU,iBAC7BtC,OAAA;YAAKgJ,SAAS,EAAC,kBAAkB;YAAAC,QAAA,gBAC/BjJ,OAAA;cAAAiJ,QAAA,gBAAGjJ,OAAA;gBAAAiJ,QAAA,EAAQ;cAAkB;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,iBAAa,EAAC/G,UAAU,CAAC0F,OAAO,CAAC,CAAC,CAAC,EAAC,MAAI;YAAA;cAAAkB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,eAClFrJ,OAAA;cAAAiJ,QAAA,eAAGjJ,OAAA;gBAAAiJ,QAAA,EAAI;cAAuD;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACpE,CACN;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAENrJ,OAAA;QACEmK,OAAO,EAAE/C,mBAAoB;QAC7B4B,SAAS,EAAC,qBAAqB;QAC/BoB,QAAQ,EAAE1I,cAAe;QAAAuH,QAAA,EAExBvH,cAAc,GACX,gBAAgB,GACfd,mBAAmB,GAChB,mBAAmB,GACnB;MAAqB;QAAAsI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvB,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CACN;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV,CAAC;AAAChJ,EAAA,CA/qBIJ,UAAU;EAAA,QASmEN,WAAW,EACdE,WAAW,EACUD,WAAW;AAAA;AAAA8K,EAAA,GAX1GzK,UAAU;AAirBhB,eAAeA,UAAU;AAAC,IAAAyK,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}